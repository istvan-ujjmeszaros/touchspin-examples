"use strict";var TouchSpinJQueryBootstrap4=(()=>{var p=(s=>(s.UPDATE_SETTINGS="touchspin.updatesettings",s.UP_ONCE="touchspin.uponce",s.DOWN_ONCE="touchspin.downonce",s.START_UP_SPIN="touchspin.startupspin",s.START_DOWN_SPIN="touchspin.startdownspin",s.STOP_SPIN="touchspin.stopspin",s.DESTROY="touchspin.destroy",s))(p||{});var f={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,forcestepdivisibility:"round",stepinterval:100,stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"\u2212",verticalupclass:null,verticaldownclass:null,focusablebuttons:!1,prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttonup_class:null,buttondown_class:null,buttonup_txt:"+",buttondown_txt:"&minus;",callback_before_calculation:s=>s,callback_after_calculation:s=>s,renderer:null},h="_touchSpinCore",y=class x{constructor(t,i={}){if(this._teardownCallbacks=[],this._settingObservers=new Map,this._spinDelayTimeout=null,this._spinIntervalTimer=null,this._upButton=null,this._originalAttributes=null,this._downButton=null,this._mutationObserver=null,this._wrapper=null,!t||t.nodeName!=="INPUT")throw new Error("TouchSpinCore requires an <input> element");this.input=t;let e=this._parseDataAttributes(t),n=typeof globalThis!="undefined"&&globalThis.TouchSpinDefaultOptions?x.sanitizePartialSettings(globalThis.TouchSpinDefaultOptions,f):{};if(this.settings=Object.assign({},f,n,e,i),this._sanitizeSettings(),this._currentStepSize=this.settings.step||1,!this.settings.renderer){let r=globalThis;r!=null&&r.TouchSpinDefaultRenderer?this.settings.renderer=r.TouchSpinDefaultRenderer:console.warn("TouchSpin: No renderer specified (renderer: null). Only keyboard/wheel events will work. Consider using Bootstrap3/4/5Renderer or TailwindRenderer for UI.")}if(this.spinning=!1,this.spincount=0,this.direction=!1,this._teardownCallbacks=[],this._settingObservers=new Map,this._spinDelayTimeout=null,this._spinIntervalTimer=null,this._upButton=null,this._downButton=null,this._wrapper=null,this._handleUpMouseDown=this._handleUpMouseDown.bind(this),this._handleDownMouseDown=this._handleDownMouseDown.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleUpKeyDown=this._handleUpKeyDown.bind(this),this._handleUpKeyUp=this._handleUpKeyUp.bind(this),this._handleDownKeyDown=this._handleDownKeyDown.bind(this),this._handleDownKeyUp=this._handleDownKeyUp.bind(this),this._handleWindowChangeCapture=this._handleWindowChangeCapture.bind(this),this._handleKeyDown=this._handleKeyDown.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleWheel=this._handleWheel.bind(this),this._initializeInput(),this.settings.renderer){let r=this.settings.renderer;this.renderer=new r(t,this.settings,this),this.renderer.init()}this._setupMutationObserver(),this.renderer&&this.renderer.finalizeWrapperAttributes(),this.input.setAttribute("data-touchspin-injected","input")}static sanitizePartialSettings(t,i){let e={...t};if(Object.hasOwn(t,"step")){let a=Number(t.step);e.step=Number.isFinite(a)&&a>0?a:1}if(Object.hasOwn(t,"decimals")){let a=Number(t.decimals);e.decimals=Number.isFinite(a)&&a>=0?Math.floor(a):0}let n=Object.hasOwn(t,"min"),r=Object.hasOwn(t,"max");if(n)if(t.min===null||t.min===void 0||typeof t.min=="string"&&t.min==="")e.min=null;else{let a=Number(t.min);e.min=Number.isFinite(a)?a:null}if(r)if(t.max===null||t.max===void 0||typeof t.max=="string"&&t.max==="")e.max=null;else{let a=Number(t.max);e.max=Number.isFinite(a)?a:null}if(n&&r&&e.min!=null&&e.max!=null&&typeof e.min=="number"&&typeof e.max=="number"&&e.min>e.max){let a=e.min;e.min=e.max,e.max=a}if(Object.hasOwn(t,"stepinterval")){let a=Number(t.stepinterval);e.stepinterval=Number.isFinite(a)&&a>=0?a:f.stepinterval}if(Object.hasOwn(t,"stepintervaldelay")){let a=Number(t.stepintervaldelay);e.stepintervaldelay=Number.isFinite(a)&&a>=0?a:f.stepintervaldelay}return e}_initializeInput(){var i;this._captureOriginalAttributes();let t=(i=this.settings.initval)!=null?i:"";t!==""&&this.input.value===""&&(this.input.value=String(t)),this._updateAriaAttributes(),this._syncNativeAttributes(),this._checkValue(!1)}_sanitizeSettings(){let t=Number(this.settings.step);!Number.isFinite(t)||t<=0?this.settings.step=1:this.settings.step=t;let i=Number(this.settings.decimals);if(!Number.isFinite(i)||i<0?this.settings.decimals=0:this.settings.decimals=Math.floor(i),this.settings.min===null||this.settings.min===void 0||typeof this.settings.min=="string"&&this.settings.min==="")this.settings.min=null;else{let r=Number(this.settings.min);this.settings.min=Number.isFinite(r)?r:null}if(this.settings.max===null||this.settings.max===void 0||typeof this.settings.max=="string"&&this.settings.max==="")this.settings.max=null;else{let r=Number(this.settings.max);this.settings.max=Number.isFinite(r)?r:null}if(this.settings.min!==null&&this.settings.max!==null&&this.settings.min>this.settings.max){let r=this.settings.min;this.settings.min=this.settings.max,this.settings.max=r}let e=Number(this.settings.stepinterval);(!Number.isFinite(e)||e<0)&&(this.settings.stepinterval=f.stepinterval);let n=Number(this.settings.stepintervaldelay);(!Number.isFinite(n)||n<0)&&(this.settings.stepintervaldelay=f.stepintervaldelay),this._validateCallbacks(),this._checkCallbackPairing()}_validateCallbacks(){if(this.input.getAttribute("type")!=="number")return;let i=r=>r;if(!this.settings.callback_after_calculation||this.settings.callback_after_calculation.toString()===i.toString())return;let n=this.settings.callback_after_calculation("123.45");/^-?\d*\.?\d*$/.test(n)||(console.warn('TouchSpin: Detected formatting callback that adds non-numeric characters. Converting input from type="number" to type="text" to support formatting like "'+n+'". This ensures compatibility with custom formatting while maintaining full TouchSpin functionality. The original type will be restored when TouchSpin is destroyed.'),this._captureOriginalAttributes(),this.input.setAttribute("type","text"),this.input.removeAttribute("min"),this.input.removeAttribute("max"),this.input.removeAttribute("step"))}_captureOriginalAttributes(){if(this._originalAttributes!==null)return;let t=["role","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","min","max","step"];this._originalAttributes={type:this.input.getAttribute("type"),attributes:new Map},t.forEach(i=>{var e;(e=this._originalAttributes)==null||e.attributes.set(i,this.input.getAttribute(i))})}_restoreOriginalAttributes(){if(this._originalAttributes===null)return;let t=this.input.value;if(t&&this.settings.callback_before_calculation){let i=this.settings.callback_before_calculation(t);this.input.value=i}this._originalAttributes.type&&this.input.setAttribute("type",this._originalAttributes.type),this._originalAttributes.attributes.forEach((i,e)=>{i===null?this.input.removeAttribute(e):this.input.setAttribute(e,i)}),this._originalAttributes=null}_parseDataAttributes(t){let i={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalup:"vertical-up",verticaldown:"vertical-down",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"},e={};for(let[n,r]of Object.entries(i)){let a=`data-bts-${r}`;if(t.hasAttribute(a)){let u=t.getAttribute(a);e[n]=this._coerceAttributeValue(n,u!=null?u:"")}}for(let n of["min","max","step"])if(t.hasAttribute(n)){let r=t.getAttribute(n);e[n]!==void 0&&console.warn(`Both "data-bts-${n}" and "${n}" attributes specified. Native attribute takes precedence.`,t),e[n]=this._coerceAttributeValue(n,r!=null?r:"")}return e}_coerceAttributeValue(t,i){if(i==null)return i;if(["booster","mousewheel","verticalbuttons","focusablebuttons"].includes(t))return i==="true"||i===""||i===t;if(["min","max","step","decimals","stepinterval","stepintervaldelay","boostat","maxboostedstep","firstclickvalueifempty"].includes(t)){let e=parseFloat(i);return Number.isNaN(e)?i:e}return i}upOnce(){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let t=this.getValue(),i=this._nextValue("up",t);if(this.settings.max!==null&&t===this.settings.max){this.emit("max"),this.spinning&&this.direction==="up"&&this.stopSpin();return}this.settings.max!==null&&i===this.settings.max&&(this.emit("max"),this.spinning&&this.direction==="up"&&this.stopSpin()),this._setDisplay(i,!0)}downOnce(){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let t=this.getValue(),i=this._nextValue("down",t);if(this.settings.min!==null&&t===this.settings.min){this.emit("min"),this.spinning&&this.direction==="down"&&this.stopSpin();return}this.settings.min!==null&&i===this.settings.min&&(this.emit("min"),this.spinning&&this.direction==="down"&&this.stopSpin()),this._setDisplay(i,!0)}startUpSpin(){let t=this.getValue();if(this.settings.max!==null&&t===this.settings.max){this.emit("max");return}this._startSpin("up")}startDownSpin(){let t=this.getValue();if(this.settings.min!==null&&t===this.settings.min){this.emit("min");return}this._startSpin("down")}stopSpin(){this._clearSpinTimers(),this.spinning&&(this.direction==="up"?(this.emit("stopupspin"),this.emit("stopspin")):this.direction==="down"&&(this.emit("stopdownspin"),this.emit("stopspin"))),this.spinning=!1,this.direction=!1,this.spincount=0,this._currentStepSize=this.settings.step||1}updateSettings(t){let i={...this.settings},e=t||{},n=x.sanitizePartialSettings(e,i);Object.assign(this.settings,n),this._sanitizeSettings();let r=Number(this.settings.step||1);(n.step!==void 0||n.min!==void 0||n.max!==void 0)&&r!==1&&(this.settings.max!==null&&(this.settings.max=this._alignToStep(Number(this.settings.max),r,"down")),this.settings.min!==null&&(this.settings.min=this._alignToStep(Number(this.settings.min),r,"up"))),Object.keys(this.settings).forEach(a=>{if(i[a]!==this.settings[a]){let u=this._settingObservers.get(String(a));u&&u.forEach(o=>{try{o(this.settings[a],i[a])}catch(l){console.error("TouchSpin: Error in setting observer callback:",l)}})}}),this._updateAriaAttributes(),this._syncNativeAttributes(),this._checkValue(!0),this._currentStepSize=this.settings.step||1,this._checkCallbackPairing()}getValue(){var r;let t=this.input.value,i=(r=this.settings.replacementval)!=null?r:"";if(t===""&&i!==""&&(t=String(i)),t==="")return NaN;let e=this.settings.callback_before_calculation||(a=>a),n=parseFloat(e(String(t)));return Number.isNaN(n)?NaN:n}setValue(t){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let i=Number(t);if(!Number.isFinite(i))return;let e=this._applyConstraints(i),n=i!==e;this._setDisplay(e,!0,n,!1)}initDOMEventHandling(){this._findDOMElements(),this._attachDOMEventListeners()}registerTeardown(t){if(typeof t!="function")throw new Error("Teardown callback must be a function");return this._teardownCallbacks.push(t),()=>{let i=this._teardownCallbacks.indexOf(t);i>-1&&this._teardownCallbacks.splice(i,1)}}destroy(){var i;this.input.removeAttribute("data-touchspin-injected"),this.stopSpin(),(i=this.renderer)!=null&&i.teardown&&this.renderer.teardown(),this._detachDOMEventListeners(),this._teardownCallbacks.forEach(e=>{try{e()}catch(n){console.error("TouchSpin teardown callback error:",n)}}),this._teardownCallbacks.length=0,this._settingObservers.clear(),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),this._upButton=null,this._downButton=null,this._restoreOriginalAttributes();let t=this.input[h];t&&t===this&&delete this.input[h]}toPublicApi(){return{upOnce:this.upOnce.bind(this),downOnce:this.downOnce.bind(this),startUpSpin:this.startUpSpin.bind(this),startDownSpin:this.startDownSpin.bind(this),stopSpin:this.stopSpin.bind(this),updateSettings:this.updateSettings.bind(this),getValue:this.getValue.bind(this),setValue:this.setValue.bind(this),destroy:this.destroy.bind(this),initDOMEventHandling:this.initDOMEventHandling.bind(this),registerTeardown:this.registerTeardown.bind(this),attachUpEvents:this.attachUpEvents.bind(this),attachDownEvents:this.attachDownEvents.bind(this),observeSetting:this.observeSetting.bind(this)}}attachUpEvents(t){if(!t){console.warn("TouchSpin: attachUpEvents called with null element");return}this._upButton=t,t.addEventListener("mousedown",this._handleUpMouseDown),t.addEventListener("touchstart",this._handleUpMouseDown,{passive:!1}),this.settings.focusablebuttons&&(t.addEventListener("keydown",this._handleUpKeyDown),t.addEventListener("keyup",this._handleUpKeyUp)),this._updateButtonDisabledState()}attachDownEvents(t){if(!t){console.warn("TouchSpin: attachDownEvents called with null element");return}this._downButton=t,t.addEventListener("mousedown",this._handleDownMouseDown),t.addEventListener("touchstart",this._handleDownMouseDown,{passive:!1}),this.settings.focusablebuttons&&(t.addEventListener("keydown",this._handleDownKeyDown),t.addEventListener("keyup",this._handleDownKeyUp)),this._updateButtonDisabledState()}observeSetting(t,i){let e=String(t);this._settingObservers.has(e)||this._settingObservers.set(e,new Set);let n=this._settingObservers.get(e);return n.add(i),()=>n.delete(i)}emit(t,i,e=!1){let n=`touchspin.on.${t}`,r=new CustomEvent(n,{detail:i,bubbles:!0,cancelable:e});return!this.input.dispatchEvent(r)}_startSpin(t){if(this.input.disabled||this.input.hasAttribute("readonly")||this.spinning&&this.direction===t)return;if(this.spinning&&this.direction!==t&&this.stopSpin(),!this.spinning||this.direction!==t){if(this.spinning=!0,this.direction=t,this.spincount=0,this._currentStepSize=this.settings.step||1,this.emit("startspin"),t==="up"){if(this.emit("startupspin",void 0,!0)){this.spinning=!1,this.direction=!1;return}}else if(this.emit("startdownspin",void 0,!0)){this.spinning=!1,this.direction=!1;return}}t==="up"?this.upOnce():this.downOnce();let e=this.getValue();if(t==="up"&&this.settings.max!==null&&e===this.settings.max||t==="down"&&this.settings.min!==null&&e===this.settings.min)return;this._clearSpinTimers();let n=this.settings.stepintervaldelay||500,r=this.settings.stepinterval||100;this._spinDelayTimeout=setTimeout(()=>{this._spinDelayTimeout=null,this._spinIntervalTimer=setInterval(()=>{!this.spinning||this.direction!==t||this._spinStep(t)},r)},n)}_clearSpinTimers(){try{this._spinDelayTimeout&&clearTimeout(this._spinDelayTimeout)}catch(t){}try{this._spinIntervalTimer&&clearInterval(this._spinIntervalTimer)}catch(t){}this._spinDelayTimeout=null,this._spinIntervalTimer=null}_nextValue(t,i){var n;let e=i;if(Number.isNaN(e))e=this._valueIfIsNaN();else{let r=this.settings.step||1,a=this.settings.maxboostedstep,u=r;if(this.settings.booster){let c=Math.max(1,parseInt(String(this.settings.boostat||10),10));u=2**Math.floor(this.spincount/c)*r}let o=u;a&&Number.isFinite(a)&&u>Number(a)&&(o=Number(a),e=Math.round(e/o)*o),o=Math.max(r,o);let l=(n=this._currentStepSize)!=null?n:r;if(o<l&&(o=l),o>this._currentStepSize){let c=Math.floor(Math.log2(this._currentStepSize/r)),_=Math.floor(Math.log2(o/r)),g={currentLevel:c,newLevel:_,currentStep:this._currentStepSize,newStep:o,direction:t};if(this.emit("speedchange",g,!0))o=this._currentStepSize;else{let d=Number(g.newStep);Number.isFinite(d)&&d>=this.settings.step?o=Math.min(d,this.settings.maxboostedstep||Number.MAX_SAFE_INTEGER):o=this._currentStepSize}}this._currentStepSize=o,e=t==="up"?e+o:e-o}return this._applyConstraints(e)}_valueIfIsNaN(){if(typeof this.settings.firstclickvalueifempty=="number")return this.settings.firstclickvalueifempty;let t=typeof this.settings.min=="number"?this.settings.min:0,i=typeof this.settings.max=="number"?this.settings.max:t;return(t+i)/2}_applyConstraints(t){var a,u;let i=this._forcestepdivisibility(t),e=(a=this.settings.min)!=null?a:null,n=(u=this.settings.max)!=null?u:null,r=i;return typeof e=="number"&&r<e&&(r=e),typeof n=="number"&&r>n&&(r=n),r}_getBoostedStep(){let t=this.settings.step||1;if(!this.settings.booster)return t;let i=Math.max(1,parseInt(String(this.settings.boostat||10),10)),e=2**Math.floor(this.spincount/i)*t,n=this.settings.maxboostedstep;if(n&&Number.isFinite(n)){let r=Number(n);e>r&&(e=r)}return Math.max(t,e)}_forcestepdivisibility(t){let i=this.settings.forcestepdivisibility||"round",e=this.settings.step||1,n=this.settings.decimals||0,r;switch(i){case"floor":r=Math.floor(t/e)*e;break;case"ceil":r=Math.ceil(t/e)*e;break;case"none":r=t;break;default:r=Math.round(t/e)*e;break}return Number(r.toFixed(n))}_alignToStep(t,i,e){if(i===0)return t;let n=1,r=i;for(;r*n%1!==0&&n<1e6;)n*=10;let a=Math.round(t*n),u=Math.round(i*n),o=a%u;return o===0?t:(e==="down"?a-o:a+(u-o))/n}_setDisplay(t,i,e=!1,n=!1){var u;let r=String((u=this.input.value)!=null?u:""),a=this._formatDisplay(t);return this.input.value=a,this._updateAriaAttributes(),i&&(n?e:e||r!==a)&&this.input.dispatchEvent(new Event("change",{bubbles:!0})),a}_formatDisplay(t){let i=this.settings.decimals||0,e=this.settings.callback_after_calculation||(r=>r),n=Number(t).toFixed(i);return e(n)}_spinStep(t){this.spincount++,t==="up"?this.upOnce():this.downOnce()}_checkValue(t){let i=this.getValue();if(!Number.isFinite(i))return;let e=this._applyConstraints(i),n=i!==e;this._setDisplay(e,!!t,n)}_updateAriaAttributes(){var u,o;let t=this.input;t.getAttribute("role")!=="spinbutton"&&t.setAttribute("role","spinbutton");let i=(u=this.settings.min)!=null?u:null,e=(o=this.settings.max)!=null?o:null;typeof i=="number"?t.setAttribute("aria-valuemin",String(i)):t.removeAttribute("aria-valuemin"),typeof e=="number"?t.setAttribute("aria-valuemax",String(e)):t.removeAttribute("aria-valuemax");let n=t.value,r=this.settings.callback_before_calculation||(l=>l),a=parseFloat(r(String(n)));Number.isFinite(a)?t.setAttribute("aria-valuenow",String(a)):t.removeAttribute("aria-valuenow"),t.setAttribute("aria-valuetext",String(n))}_syncNativeAttributes(){var t,i;if(this.input.getAttribute("type")==="number"){let e=(t=this.settings.min)!=null?t:null;typeof e=="number"&&Number.isFinite(e)?this.input.setAttribute("min",String(e)):this.input.removeAttribute("min");let n=(i=this.settings.max)!=null?i:null;typeof n=="number"&&Number.isFinite(n)?this.input.setAttribute("max",String(n)):this.input.removeAttribute("max");let r=this.settings.step;typeof r=="number"&&Number.isFinite(r)&&r>0?this.input.setAttribute("step",String(r)):this.input.removeAttribute("step")}}_syncSettingsFromNativeAttributes(){let t=this.input.getAttribute("min"),i=this.input.getAttribute("max"),e=this.input.getAttribute("step"),n=!1,r={};if(t!==null){let a=t===""?null:parseFloat(t),u=a!==null&&Number.isFinite(a)?a:null;u!==this.settings.min&&(r.min=u,n=!0)}else this.settings.min!==null&&(r.min=null,n=!0);if(i!==null){let a=i===""?null:parseFloat(i),u=a!==null&&Number.isFinite(a)?a:null;u!==this.settings.max&&(r.max=u,n=!0)}else this.settings.max!==null&&(r.max=null,n=!0);if(e!==null){let a=e===""?void 0:parseFloat(e),u=a!==void 0&&Number.isFinite(a)&&a>0?a:void 0;u!==this.settings.step&&(r.step=u!=null?u:1,n=!0)}else this.settings.step!==1&&(r.step=1,n=!0);n&&this.updateSettings(r)}_findDOMElements(){let t=this.input.parentElement;for(;t&&!t.hasAttribute("data-touchspin-injected");)t=t.parentElement;this._wrapper=t}_attachDOMEventListeners(){document.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("mouseleave",this._handleMouseUp),document.addEventListener("touchend",this._handleMouseUp),window.addEventListener("change",this._handleWindowChangeCapture,!0),this.input.addEventListener("keydown",this._handleKeyDown),this.input.addEventListener("keyup",this._handleKeyUp),this.input.addEventListener("wheel",this._handleWheel)}_detachDOMEventListeners(){document.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("mouseleave",this._handleMouseUp),document.removeEventListener("touchend",this._handleMouseUp),window.removeEventListener("change",this._handleWindowChangeCapture,!0),this.input.removeEventListener("keydown",this._handleKeyDown),this.input.removeEventListener("keyup",this._handleKeyUp),this.input.removeEventListener("wheel",this._handleWheel)}_handleUpMouseDown(t){t.preventDefault(),this.startUpSpin()}_handleDownMouseDown(t){t.preventDefault(),this.startDownSpin()}_handleMouseUp(t){this.stopSpin()}_handleUpKeyDown(t){if(t.keyCode===13||t.keyCode===32){if(t.preventDefault(),t.repeat)return;this.startUpSpin()}}_handleUpKeyUp(t){(t.keyCode===13||t.keyCode===32)&&this.stopSpin()}_handleDownKeyDown(t){if(t.keyCode===13||t.keyCode===32){if(t.preventDefault(),t.repeat)return;this.startDownSpin()}}_handleDownKeyUp(t){(t.keyCode===13||t.keyCode===32)&&this.stopSpin()}_handleWindowChangeCapture(t){let i=t.target;if(!i||i!==this.input)return;let e=this.getValue();if(!Number.isFinite(e))return;let n=this._applyConstraints(e);n!==e&&this._setDisplay(n,!1)}_handleKeyDown(t){switch(t.key){case"ArrowUp":if(t.preventDefault(),t.repeat)return;this.startUpSpin();break;case"ArrowDown":if(t.preventDefault(),t.repeat)return;this.startDownSpin();break;case"Enter":this._checkValue(!1);break}}_handleKeyUp(t){(t.key==="ArrowUp"||t.key==="ArrowDown")&&this.stopSpin()}_handleWheel(t){this.settings.mousewheel&&document.activeElement===this.input&&(t.preventDefault(),t.deltaY<0?this.upOnce():t.deltaY>0&&this.downOnce())}_setupMutationObserver(){typeof MutationObserver!="undefined"&&(this._mutationObserver=new MutationObserver(t=>{t.forEach(i=>{i.type==="attributes"&&(i.attributeName==="disabled"||i.attributeName==="readonly"?this._updateButtonDisabledState():(i.attributeName==="min"||i.attributeName==="max"||i.attributeName==="step")&&this._syncSettingsFromNativeAttributes())})}),this._mutationObserver.observe(this.input,{attributes:!0,attributeFilter:["disabled","readonly","min","max","step"]}))}_updateButtonDisabledState(){let t=this.input.disabled||this.input.hasAttribute("readonly");this._upButton&&(this._upButton.disabled=t),this._downButton&&(this._downButton.disabled=t),t&&this.stopSpin()}_checkCallbackPairing(){var n,r,a,u;let t=o=>o,i=this.settings.callback_before_calculation&&this.settings.callback_before_calculation.toString()!==t.toString(),e=this.settings.callback_after_calculation&&this.settings.callback_after_calculation.toString()!==t.toString();if(i&&!e?console.warn("TouchSpin: callback_before_calculation is defined but callback_after_calculation is missing. These callbacks should be used together - one removes formatting, the other adds it back."):!i&&e&&console.warn("TouchSpin: callback_after_calculation is defined but callback_before_calculation is missing. These callbacks should be used together - one removes formatting, the other adds it back."),i&&e){let o=[],l=this.settings.decimals||0,c=b=>b.toFixed(l),_=this.settings.min!==null&&this.settings.min!==void 0,g=this.settings.max!==null&&this.settings.max!==void 0;_&&g?o.push(c(this.settings.min),c(this.settings.max)):_?o.push(c(this.settings.min)):g?o.push(c(this.settings.max)):o.push(l>0?"50.55":"50");let d=[];for(let b of o){let w=(r=(n=this.settings).callback_after_calculation)==null?void 0:r.call(n,b);if(w===void 0)continue;let S=(u=(a=this.settings).callback_before_calculation)==null?void 0:u.call(a,w);S!==void 0&&S!==b&&d.push(`"${b}" \u2192 after \u2192 "${w}" \u2192 before \u2192 "${S}" (expected "${b}")`)}d.length>0&&console.warn(`TouchSpin: Callbacks are not properly paired - round-trip test failed:
`+d.join(`
`)+`
callback_before_calculation must reverse what callback_after_calculation does. For example, if after adds " USD", before must strip " USD".`)}}};function A(s,t){var i;if(!s||s.nodeName!=="INPUT")return console.warn("Must be an input."),null;if(t!==void 0){s[h]&&(console.warn("TouchSpin: Destroying existing instance and reinitializing. Consider using updateSettings() instead."),(i=s[h])==null||i.destroy());let e=new y(s,t);return s[h]=e,e.initDOMEventHandling(),e.toPublicApi()}if(!s[h]){let e=new y(s,{});return s[h]=e,e.initDOMEventHandling(),e.toPublicApi()}return s[h].toPublicApi()}var j=Object.freeze({MIN:"min",MAX:"max",START_SPIN:"startspin",START_UP:"startupspin",START_DOWN:"startdownspin",STOP_SPIN:"stopspin",STOP_UP:"stopupspin",STOP_DOWN:"stopdownspin"});function T(s,t,i){let e=typeof s=="string"?document.querySelector(s):s;if(!e)throw new Error(`TouchSpin mount failed: element not found${typeof s=="string"?` (selector: "${s}")`:""}`);if(!(e instanceof HTMLInputElement))throw new Error("TouchSpin mount failed: element must be an HTMLInputElement");return A(e,{...t,renderer:i})}var v="data-testid",m="data-touchspin-injected",O=class{constructor(s,t,i){this.wrapper=null,this.wrapperType="wrapper",this.input=s,this.settings=t,this.core=i}finalizeWrapperAttributes(){var t,i,e;let s=this.input.getAttribute(v);s&&!((t=this.wrapper)!=null&&t.hasAttribute(v))&&((i=this.wrapper)==null||i.setAttribute(v,`${s}-wrapper`)),(e=this.wrapper)==null||e.setAttribute(m,this.wrapperType)}getUpButtonTestId(){return this.buildDataTestId("up")}getDownButtonTestId(){return this.buildDataTestId("down")}getPrefixTestId(){return this.buildDataTestId("prefix")}getPostfixTestId(){return this.buildDataTestId("postfix")}filterRendererSettings(s,t=this.settings){let i={};for(let e in s)Object.hasOwn(t,e)&&(i[e]=t[e]);return i}buildDataTestId(s){let t=this.input.getAttribute(v);return t?` data-testid="${t}-${s}"`:""}},I=O,P="wrapper-advanced",C="bootstrap-touchspin",M=class extends I{teardown(){this.removeInjectedElements()}removeInjectedElements(){this.removeInjectedNodesWithinWrapper(),this.removeNearbyInjectedNodes()}removeInjectedNodesWithinWrapper(){let{wrapper:s}=this;if(!s||(s.querySelectorAll(`[${m}]`).forEach(i=>i.remove()),!s.hasAttribute(m)||!s.parentElement))return;if(s.getAttribute(m)===P){s.classList.remove(C),s.removeAttribute(m);return}s.parentElement.insertBefore(this.input,s),s.remove()}removeNearbyInjectedNodes(){document.querySelectorAll(`[${m}]`).forEach(t=>{t instanceof HTMLElement&&t!==this.input&&this.isNodeRelatedToInput(t)&&t.remove()})}isNodeRelatedToInput(s){var t,i;return s.contains(this.input)||((i=(t=this.input.parentElement)==null?void 0:t.contains(s))!=null?i:!1)}},N=M;var $=class extends N{constructor(){super(...arguments),this.prefixEl=null,this.postfixEl=null,this.initialInputGroup=null}init(){this.prefixEl=null,this.postfixEl=null,this.initialInputGroup=this.input.closest(".input-group"),this.input.classList.contains("form-control")||(this.input.classList.add("form-control"),this._formControlAdded=!0),this.buildAndAttachDOM(),this.core.observeSetting("prefix",s=>this.updatePrefix(s)),this.core.observeSetting("postfix",s=>this.updatePostfix(s)),this.core.observeSetting("buttonup_class",s=>this.updateButtonClass("up",s)),this.core.observeSetting("buttondown_class",s=>this.updateButtonClass("down",s)),this.core.observeSetting("verticalupclass",s=>this.updateVerticalButtonClass("up",s)),this.core.observeSetting("verticaldownclass",s=>this.updateVerticalButtonClass("down",s)),this.core.observeSetting("verticalup",s=>this.updateVerticalButtonText("up",s)),this.core.observeSetting("verticaldown",s=>this.updateVerticalButtonText("down",s)),this.core.observeSetting("buttonup_txt",s=>this.updateButtonText("up",s)),this.core.observeSetting("buttondown_txt",s=>this.updateButtonText("down",s)),this.core.observeSetting("prefix_extraclass",s=>this.updatePrefixClasses()),this.core.observeSetting("postfix_extraclass",s=>this.updatePostfixClasses()),this.core.observeSetting("verticalbuttons",s=>this.handleVerticalButtonsChange(s)),this.core.observeSetting("focusablebuttons",s=>this.updateButtonFocusability(s))}teardown(){this._formControlAdded&&(this.input.classList.remove("form-control"),this._formControlAdded=!1),super.teardown()}buildInputGroup(){let s=this.input.closest(".input-group"),t=s!=null?s:this.initialInputGroup;return t?this.buildAdvancedInputGroup(t):this.buildBasicInputGroup()}buildBasicInputGroup(){let s=this._detectInputGroupSize(),t;this.settings.verticalbuttons?t=`
        <div class="input-group ${s} bootstrap-touchspin">
          ${this.settings.prefix?`<div class="input-group-prepend bootstrap-touchspin-prefix" data-touchspin-injected="prefix"${this.getPrefixTestId()}>
            <span class="input-group-text ${this.settings.prefix_extraclass||""}">${this.settings.prefix}</span>
          </div>`:""}
          ${this.settings.postfix?`<div class="input-group-append bootstrap-touchspin-postfix" data-touchspin-injected="postfix"${this.getPostfixTestId()}>
            <span class="input-group-text ${this.settings.postfix_extraclass||""}">${this.settings.postfix}</span>
          </div>`:""}
          ${this.buildVerticalButtons()}
        </div>
      `:t=`
        <div class="input-group ${s} bootstrap-touchspin">
          <div class="input-group-prepend" data-touchspin-injected="prepend-wrapper">
            <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="${this.settings.buttondown_class||"btn btn-outline-secondary"} bootstrap-touchspin-down" data-touchspin-injected="down"${this.getDownButtonTestId()} type="button" aria-label="Decrease value">${this.settings.buttondown_txt}</button>
            ${this.settings.prefix?`<span class="input-group-text bootstrap-touchspin-prefix ${this.settings.prefix_extraclass||""}" data-touchspin-injected="prefix"${this.getPrefixTestId()}>${this.settings.prefix}</span>`:""}
          </div>
          <div class="input-group-append" data-touchspin-injected="append-wrapper">
            ${this.settings.postfix?`<span class="input-group-text bootstrap-touchspin-postfix ${this.settings.postfix_extraclass||""}" data-touchspin-injected="postfix"${this.getPostfixTestId()}>${this.settings.postfix}</span>`:""}
            <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="${this.settings.buttonup_class||"btn btn-outline-secondary"} bootstrap-touchspin-up" data-touchspin-injected="up"${this.getUpButtonTestId()} type="button" aria-label="Increase value">${this.settings.buttonup_txt}</button>
          </div>
        </div>
      `;let i=document.createElement("div");i.innerHTML=t.trim();let e=i.firstChild;if(this.input.parentElement&&this.input.parentElement.insertBefore(e,this.input),this.settings.verticalbuttons){let n=e.querySelector('[data-touchspin-injected="prefix"]'),r=e.querySelector('[data-touchspin-injected="postfix"]');if(n)e.insertBefore(this.input,n.nextSibling);else if(r)e.insertBefore(this.input,r);else{let a=e.querySelector('[data-touchspin-injected="vertical-wrapper"]');a&&e.insertBefore(this.input,a)}}else{let n=e.querySelector('[data-touchspin-injected="append-wrapper"]');n&&e.insertBefore(this.input,n)}return e}buildAdvancedInputGroup(s){s.classList.add("bootstrap-touchspin"),this.wrapperType="wrapper-advanced";let t;this.settings.verticalbuttons?t=`
        ${this.settings.prefix?`<div class="input-group-prepend bootstrap-touchspin-prefix" data-touchspin-injected="prefix"${this.getPrefixTestId()}>
          <span class="input-group-text ${this.settings.prefix_extraclass||""}">${this.settings.prefix}</span>
        </div>`:""}
        ${this.settings.postfix?`<div class="input-group-append bootstrap-touchspin-postfix" data-touchspin-injected="postfix"${this.getPostfixTestId()}>
          <span class="input-group-text ${this.settings.postfix_extraclass||""}">${this.settings.postfix}</span>
        </div>`:""}
        ${this.buildVerticalButtons()}
      `:t=`
        <div class="input-group-prepend" data-touchspin-injected="prepend-wrapper">
          <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="${this.settings.buttondown_class||"btn btn-outline-secondary"} bootstrap-touchspin-down" data-touchspin-injected="down"${this.getDownButtonTestId()} type="button">${this.settings.buttondown_txt}</button>
          ${this.settings.prefix?`<span class="input-group-text bootstrap-touchspin-prefix ${this.settings.prefix_extraclass||""}" data-touchspin-injected="prefix"${this.getPrefixTestId()}>${this.settings.prefix}</span>`:""}
        </div>
        <div class="input-group-append" data-touchspin-injected="append-wrapper">
          ${this.settings.postfix?`<span class="input-group-text bootstrap-touchspin-postfix ${this.settings.postfix_extraclass||""}" data-touchspin-injected="postfix"${this.getPostfixTestId()}>${this.settings.postfix}</span>`:""}
          <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="${this.settings.buttonup_class||"btn btn-outline-secondary"} bootstrap-touchspin-up" data-touchspin-injected="up"${this.getUpButtonTestId()} type="button">${this.settings.buttonup_txt}</button>
        </div>
      `;let i=document.createElement("div");i.innerHTML=t;let e,n;if(this.ensureInputInGroup(s),this.settings.verticalbuttons){e=i.querySelector('[data-touchspin-injected="prefix"]'),e&&s.insertBefore(e,this.input),n=i.querySelector('[data-touchspin-injected="postfix"]'),n&&s.insertBefore(n,this.input.nextSibling);let r=i.querySelector('[data-touchspin-injected="vertical-wrapper"]');r&&s.insertBefore(r,n?n.nextSibling:this.input.nextSibling)}else{let r=i.querySelector('[data-touchspin-injected="prepend-wrapper"]');r&&s.insertBefore(r,this.input);let a=i.querySelector('[data-touchspin-injected="append-wrapper"]');a&&s.insertBefore(a,this.input.nextSibling),e=r?r.querySelector('[data-touchspin-injected="prefix"]'):null,n=a?a.querySelector('[data-touchspin-injected="postfix"]'):null}return this.prefixEl=e,this.postfixEl=n,s}_detectInputGroupSize(){let s=this.input.className;return s.includes("form-control-sm")?"input-group-sm":s.includes("form-control-lg")?"input-group-lg":""}buildAndAttachDOM(){this.wrapper=this.buildInputGroup();let s=this.wrapper.querySelector('[data-touchspin-injected="up"]'),t=this.wrapper.querySelector('[data-touchspin-injected="down"]');this.prefixEl=this.wrapper.querySelector('[data-touchspin-injected="prefix"]'),this.postfixEl=this.wrapper.querySelector('[data-touchspin-injected="postfix"]'),this.core.attachUpEvents(s),this.core.attachDownEvents(t)}ensureInputInGroup(s){this.input.parentElement!==s&&s.appendChild(this.input)}updatePrefix(s){let t=this.prefixEl;s&&s!==""?t?(t.textContent=s,t.style.display="",t.className=`input-group-text bootstrap-touchspin-prefix ${this.settings.prefix_extraclass||""}`.trim()):this.rebuildDOM():t&&this.rebuildDOM()}updatePostfix(s){let t=this.postfixEl;s&&s!==""?t?(t.textContent=s,t.style.display="",t.className=`input-group-text bootstrap-touchspin-postfix ${this.settings.postfix_extraclass||""}`.trim()):this.rebuildDOM():t&&this.rebuildDOM()}updateButtonClass(s,t){if(!this.wrapper)return;let i=this.wrapper.querySelector(`[data-touchspin-injected="${s}"]`);i&&(i.className=`${t||"btn btn-outline-secondary"} bootstrap-touchspin-${s}`)}buildVerticalButtons(){return`
      <span class="input-group-text bootstrap-touchspin-vertical-button-wrapper" data-touchspin-injected="vertical-wrapper">
        <span class="input-group-btn-vertical">
          <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="${this.settings.buttonup_class||"btn btn-outline-secondary"} ${this.settings.verticalupclass||"btn btn-outline-secondary"} bootstrap-touchspin-up" data-touchspin-injected="up"${this.getUpButtonTestId()} type="button" aria-label="Increase value">${this.settings.verticalup}</button>
          <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="${this.settings.buttondown_class||"btn btn-outline-secondary"} ${this.settings.verticaldownclass||"btn btn-outline-secondary"} bootstrap-touchspin-down" data-touchspin-injected="down"${this.getDownButtonTestId()} type="button" aria-label="Decrease value">${this.settings.verticaldown}</button>
        </span>
      </span>
    `}updateVerticalButtonClass(s,t){if(!this.wrapper)return;let i=this.wrapper.querySelector('[data-touchspin-injected="vertical-wrapper"]');if(i){let e=i.querySelector(`[data-touchspin-injected="${s}"]`);if(e){let n=this.settings.buttonup_class||this.settings.buttondown_class||"btn btn-outline-secondary";e.className=`${n} ${t||"btn btn-outline-secondary"} bootstrap-touchspin-${s}`}}}updateVerticalButtonText(s,t){if(!this.wrapper)return;let i=this.wrapper.querySelector('[data-touchspin-injected="vertical-wrapper"]');if(i){let e=i.querySelector(`[data-touchspin-injected="${s}"]`);e&&(e.textContent=t!=null?t:"")}}updateButtonText(s,t){if(!this.wrapper)return;let i=this.wrapper.querySelector(`[data-touchspin-injected="${s}"]`);i&&(i.textContent=t!=null?t:"")}updatePrefixClasses(){let s=this.prefixEl;s&&(s.className=`input-group-text bootstrap-touchspin-prefix ${this.settings.prefix_extraclass||""}`.trim())}updatePostfixClasses(){let s=this.postfixEl;s&&(s.className=`input-group-text bootstrap-touchspin-postfix ${this.settings.postfix_extraclass||""}`.trim())}handleVerticalButtonsChange(s){this.rebuildDOM()}rebuildDOM(){this.removeInjectedElements(),this.wrapper=null,this.prefixEl=null,this.postfixEl=null,this.buildAndAttachDOM(),this.finalizeWrapperAttributes()}updateButtonFocusability(s){if(!this.wrapper)return;let t=this.wrapper.querySelectorAll('[data-touchspin-injected="up"], [data-touchspin-injected="down"]'),i=s?"0":"-1";t.forEach(e=>{e.setAttribute("tabindex",i)})}},D=$;function k(s,t){return T(s,t,D)}function U(s,t){s.fn.TouchSpin=function(i,e){if(typeof i=="string"){let n=String(i).toLowerCase(),r;return this.each(function(){let a=this,u=a.__touchspin;if((n==="getvalue"||n==="get")&&r===void 0){u?r=u.getValue():r=a.value;return}if(u)switch(n){case"destroy":u.destroy(),delete a.__touchspin;break;case"uponce":u.upOnce();break;case"downonce":u.downOnce();break;case"startupspin":u.startUpSpin();break;case"startdownspin":u.startDownSpin();break;case"stopspin":u.stopSpin();break;case"updatesettings":u.updateSettings(e||{});break;case"setvalue":case"set":u.setValue(e);break}}),r===void 0?this:r}return this.each(function(){let n=s(this),r=this,a=null;try{a=t(r,i||{})}catch(o){return}if(!a)return;r.__touchspin=a;let u=()=>{n.off(`${p.UP_ONCE} ${p.DOWN_ONCE} ${p.START_UP_SPIN} ${p.START_DOWN_SPIN} ${p.STOP_SPIN} ${p.UPDATE_SETTINGS} ${p.DESTROY} blur.touchspin`)};a.registerTeardown(u),n.on(p.UP_ONCE,()=>{let o=r.__touchspin;o&&o.upOnce()}),n.on(p.DOWN_ONCE,()=>{let o=r.__touchspin;o&&o.downOnce()}),n.on(p.START_UP_SPIN,()=>{let o=r.__touchspin;o&&o.startUpSpin()}),n.on(p.START_DOWN_SPIN,()=>{let o=r.__touchspin;o&&o.startDownSpin()}),n.on(p.STOP_SPIN,()=>{let o=r.__touchspin;o&&o.stopSpin()}),n.on(p.UPDATE_SETTINGS,(o,l)=>{let c=r.__touchspin;c&&c.updateSettings(l||{})}),n.on(p.DESTROY,()=>{let o=r.__touchspin;o&&(o.destroy(),delete r.__touchspin)}),n.on("blur.touchspin",()=>{var l;let o=r._touchSpinCore;(l=o==null?void 0:o._checkValue)==null||l.call(o,!0)})})}}function E(s){let t=globalThis.jQuery;t?U(t,s):console.warn("jQuery adapter: jQuery not found on window. Call installJQueryAdapter($, mountFn) manually.")}E(k);})();
