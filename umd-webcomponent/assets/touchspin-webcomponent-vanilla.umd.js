"use strict";var TouchSpinWCVanilla=(()=>{var w=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var U=(r,t)=>{for(var e in t)w(r,e,{get:t[e],enumerable:!0})},R=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of I(t))!P.call(r,s)&&s!==e&&w(r,s,{get:()=>t[s],enumerable:!(i=M(t,s))||i.enumerable});return r};var B=r=>R(w({},"__esModule",{value:!0}),r);var z={};U(z,{TouchSpinInput:()=>g});var _="data-testid",f="data-touchspin-injected",V=class{constructor(r,t,e){this.wrapper=null,this.wrapperType="wrapper",this.input=r,this.settings=t,this.core=e}finalizeWrapperAttributes(){let r=this.input.getAttribute(_);r&&!this.wrapper?.hasAttribute(_)&&this.wrapper?.setAttribute(_,`${r}-wrapper`),this.wrapper?.setAttribute(f,this.wrapperType)}getUpButtonTestId(){return this.buildDataTestId("up")}getDownButtonTestId(){return this.buildDataTestId("down")}getPrefixTestId(){return this.buildDataTestId("prefix")}getPostfixTestId(){return this.buildDataTestId("postfix")}filterRendererSettings(r,t=this.settings){let e={};for(let i in r)Object.hasOwn(t,i)&&(e[i]=t[i]);return e}buildDataTestId(r){let t=this.input.getAttribute(_);return t?` data-testid="${t}-${r}"`:""}},$=V,j="wrapper-advanced",L="bootstrap-touchspin",F=class extends ${teardown(){this.removeInjectedElements()}removeInjectedElements(){this.removeInjectedNodesWithinWrapper(),this.removeNearbyInjectedNodes()}removeInjectedNodesWithinWrapper(){let{wrapper:r}=this;if(!r||(r.querySelectorAll(`[${f}]`).forEach(e=>e.remove()),!r.hasAttribute(f)||!r.parentElement))return;if(r.getAttribute(f)===j){r.classList.remove(L),r.removeAttribute(f);return}r.parentElement.insertBefore(this.input,r),r.remove()}removeNearbyInjectedNodes(){document.querySelectorAll(`[${f}]`).forEach(t=>{t instanceof HTMLElement&&t!==this.input&&this.isNodeRelatedToInput(t)&&t.remove()})}isNodeRelatedToInput(r){return r.contains(this.input)||(this.input.parentElement?.contains(r)??!1)}},A=F;var W=class extends A{constructor(){super(...arguments),this.prefixEl=null,this.postfixEl=null}init(){this.prefixEl=null,this.postfixEl=null,this.wrapper=this.buildInputGroup();let r=this.wrapper,t=r.querySelector('[data-touchspin-injected="up"]'),e=r.querySelector('[data-touchspin-injected="down"]');this.prefixEl=r.querySelector('[data-touchspin-injected="prefix"]'),this.postfixEl=r.querySelector('[data-touchspin-injected="postfix"]');let i=t instanceof HTMLElement?t:null,s=e instanceof HTMLElement?e:null;this.core.attachUpEvents(i),this.core.attachDownEvents(s),this.core.observeSetting("prefix",n=>this.updatePrefix(n)),this.core.observeSetting("postfix",n=>this.updatePostfix(n)),this.core.observeSetting("buttonup_class",n=>this.updateButtonClass("up",n)),this.core.observeSetting("buttondown_class",n=>this.updateButtonClass("down",n)),this.core.observeSetting("verticalupclass",n=>this.updateVerticalButtonClass("up",n)),this.core.observeSetting("verticaldownclass",n=>this.updateVerticalButtonClass("down",n)),this.core.observeSetting("verticalup",n=>this.updateVerticalButtonText("up",n)),this.core.observeSetting("verticaldown",n=>this.updateVerticalButtonText("down",n)),this.core.observeSetting("buttonup_txt",n=>this.updateButtonText("up",n)),this.core.observeSetting("buttondown_txt",n=>this.updateButtonText("down",n)),this.core.observeSetting("prefix_extraclass",n=>this.updatePrefixClasses()),this.core.observeSetting("postfix_extraclass",n=>this.updatePostfixClasses()),this.core.observeSetting("verticalbuttons",n=>this.handleVerticalButtonsChange(n)),this.core.observeSetting("focusablebuttons",n=>this.updateButtonFocusability(n))}buildInputGroup(){let r=this.settings.verticalbuttons,t;r?t=`
        <div class="ts-wrapper ts-wrapper--vertical" data-touchspin-injected="wrapper">
          <span class="ts-addon ts-prefix ${this.settings.prefix_extraclass||""}" data-touchspin-injected="prefix"${this.getPrefixTestId()}>${this.settings.prefix||""}</span>
          <span class="ts-addon ts-postfix ${this.settings.postfix_extraclass||""}" data-touchspin-injected="postfix"${this.getPostfixTestId()}>${this.settings.postfix||""}</span>
          ${this.buildVerticalButtons()}
        </div>
      `:t=`
        <div class="ts-wrapper" data-touchspin-injected="wrapper">
          <button 
            tabindex="${this.settings.focusablebuttons?"0":"-1"}" 
            class="ts-btn ts-btn--down ${this.settings.buttondown_class||""}" 
            data-touchspin-injected="down"${this.getDownButtonTestId()} 
            type="button" 
            aria-label="Decrease value"
            ${this.input.disabled?"disabled":""}
          >${this.settings.buttondown_txt}</button>
          <span class="ts-addon ts-prefix ${this.settings.prefix_extraclass||""}" data-touchspin-injected="prefix"${this.getPrefixTestId()}>${this.settings.prefix||""}</span>
          <span class="ts-addon ts-postfix ${this.settings.postfix_extraclass||""}" data-touchspin-injected="postfix"${this.getPostfixTestId()}>${this.settings.postfix||""}</span>
          <button 
            tabindex="${this.settings.focusablebuttons?"0":"-1"}" 
            class="ts-btn ts-btn--up ${this.settings.buttonup_class||""}" 
            data-touchspin-injected="up"${this.getUpButtonTestId()} 
            type="button" 
            aria-label="Increase value"
            ${this.input.disabled?"disabled":""}
          >${this.settings.buttonup_txt}</button>
        </div>
      `;let e=document.createElement("div");e.innerHTML=t.trim();let i=e.firstChild,s=this.input.parentElement;s&&s.insertBefore(i,this.input);let n=i.querySelector('[data-touchspin-injected="postfix"]');if(n)i.insertBefore(this.input,n);else{let a=i.querySelector('[data-touchspin-injected="up"]');i.insertBefore(this.input,a)}return this.input.classList.add("ts-input"),this.hideEmptyPrefixPostfix(i),i}buildVerticalButtons(){return`
      <div class="ts-vertical-wrapper" data-touchspin-injected="vertical-wrapper">
        <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="ts-btn ts-btn--vertical ts-btn--vertical-up ${this.settings.verticalupclass||""}" data-touchspin-injected="up"${this.getUpButtonTestId()} type="button" aria-label="Increase value">${this.settings.verticalup}</button>
        <button tabindex="${this.settings.focusablebuttons?"0":"-1"}" class="ts-btn ts-btn--vertical ts-btn--vertical-down ${this.settings.verticaldownclass||""}" data-touchspin-injected="down"${this.getDownButtonTestId()} type="button" aria-label="Decrease value">${this.settings.verticaldown}</button>
      </div>
    `}hideEmptyPrefixPostfix(r=this.wrapper){let t=this.prefixEl||r?.querySelector('[data-touchspin-injected="prefix"]'),e=this.postfixEl||r?.querySelector('[data-touchspin-injected="postfix"]');t&&(!this.settings.prefix||this.settings.prefix==="")&&(t.style.display="none"),e&&(!this.settings.postfix||this.settings.postfix==="")&&(e.style.display="none")}updatePrefix(r){let t=this.prefixEl;t&&(r&&r!==""?(t.textContent=r,t.style.display="",t.className=`ts-addon ts-prefix ${this.settings.prefix_extraclass||""}`.trim()):t.style.display="none")}updatePostfix(r){let t=this.postfixEl;t&&(r&&r!==""?(t.textContent=r,t.style.display="",t.className=`ts-addon ts-postfix ${this.settings.postfix_extraclass||""}`.trim()):t.style.display="none")}updateButtonClass(r,t){if(!this.wrapper)return;let e=this.wrapper.querySelector(`[data-touchspin-injected="${r}"]`);if(!e)return;let i=`ts-btn ts-btn--${r}`,s=e.classList.contains("ts-btn--vertical")?" ts-btn--vertical":"";e.className=`${i}${s} ${t||""}`.trim()}updateVerticalButtonClass(r,t){if(!this.wrapper)return;let e=this.wrapper.querySelector('[data-touchspin-injected="vertical-wrapper"]');if(!e)return;let i=e.querySelector(`[data-touchspin-injected="${r}"]`);if(!i)return;let s=`ts-btn ts-btn--${r} ts-btn--vertical`,n=this.settings.buttonup_class||this.settings.buttondown_class||"";i.className=`${s} ${n} ${t||""}`.trim()}updateVerticalButtonText(r,t){if(!this.wrapper)return;let e=this.wrapper.querySelector('[data-touchspin-injected="vertical-wrapper"]');if(!e)return;let i=e.querySelector(`[data-touchspin-injected="${r}"]`);i&&(i.textContent=t??"")}updateButtonText(r,t){if(!this.wrapper)return;let e=this.wrapper.querySelector(`[data-touchspin-injected="${r}"]`);e&&(e.textContent=t??"")}updatePrefixClasses(){let r=this.prefixEl;r&&(r.className=`ts-addon ts-prefix ${this.settings.prefix_extraclass||""}`.trim())}updatePostfixClasses(){let r=this.postfixEl;r&&(r.className=`ts-addon ts-postfix ${this.settings.postfix_extraclass||""}`.trim())}handleVerticalButtonsChange(r){this.rebuildDOM()}rebuildDOM(){this.removeInjectedElements(),this.wrapper=null,this.prefixEl=null,this.postfixEl=null,this.buildAndAttachDOM(),this.finalizeWrapperAttributes()}buildAndAttachDOM(){this.wrapper=this.buildInputGroup();let r=this.wrapper,t=r.querySelector('[data-touchspin-injected="up"]'),e=r.querySelector('[data-touchspin-injected="down"]');this.prefixEl=r.querySelector('[data-touchspin-injected="prefix"]'),this.postfixEl=r.querySelector('[data-touchspin-injected="postfix"]');let i=t instanceof HTMLElement?t:null,s=e instanceof HTMLElement?e:null;this.core.attachUpEvents(i),this.core.attachDownEvents(s)}updateButtonFocusability(r){if(!this.wrapper)return;let t=this.wrapper.querySelectorAll('[data-touchspin-injected="up"], [data-touchspin-injected="down"]'),e=r?"0":"-1";t.forEach(i=>{i.setAttribute("tabindex",e)})}setTheme(r){let t=this.wrapper;!t||!r||Object.entries(r).forEach(([e,i])=>{let s=e.startsWith("--")?e:`--ts-${e}`;t.style.setProperty(s,i)})}teardown(){this.input.classList.remove("ts-input"),super.teardown()}},T=W;var m={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,forcestepdivisibility:"round",stepinterval:100,stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"\u2212",verticalupclass:null,verticaldownclass:null,focusablebuttons:!1,prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttonup_class:null,buttondown_class:null,buttonup_txt:"+",buttondown_txt:"&minus;",callback_before_calculation:r=>r,callback_after_calculation:r=>r,renderer:null},h="_touchSpinCore",E=class x{constructor(t,e={}){if(this._teardownCallbacks=[],this._settingObservers=new Map,this._spinDelayTimeout=null,this._spinIntervalTimer=null,this._upButton=null,this._originalAttributes=null,this._downButton=null,this._mutationObserver=null,this._wrapper=null,!t||t.nodeName!=="INPUT")throw new Error("TouchSpinCore requires an <input> element");this.input=t;let i=this._parseDataAttributes(t),s=typeof globalThis<"u"&&globalThis.TouchSpinDefaultOptions?x.sanitizePartialSettings(globalThis.TouchSpinDefaultOptions,m):{};if(this.settings=Object.assign({},m,s,i,e),this._sanitizeSettings(),this._currentStepSize=this.settings.step||1,!this.settings.renderer){let n=globalThis;n?.TouchSpinDefaultRenderer?this.settings.renderer=n.TouchSpinDefaultRenderer:console.warn("TouchSpin: No renderer specified (renderer: null). Only keyboard/wheel events will work. Consider using Bootstrap3/4/5Renderer or TailwindRenderer for UI.")}if(this.spinning=!1,this.spincount=0,this.direction=!1,this._teardownCallbacks=[],this._settingObservers=new Map,this._spinDelayTimeout=null,this._spinIntervalTimer=null,this._upButton=null,this._downButton=null,this._wrapper=null,this._handleUpMouseDown=this._handleUpMouseDown.bind(this),this._handleDownMouseDown=this._handleDownMouseDown.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleUpKeyDown=this._handleUpKeyDown.bind(this),this._handleUpKeyUp=this._handleUpKeyUp.bind(this),this._handleDownKeyDown=this._handleDownKeyDown.bind(this),this._handleDownKeyUp=this._handleDownKeyUp.bind(this),this._handleWindowChangeCapture=this._handleWindowChangeCapture.bind(this),this._handleKeyDown=this._handleKeyDown.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleWheel=this._handleWheel.bind(this),this._initializeInput(),this.settings.renderer){let n=this.settings.renderer;this.renderer=new n(t,this.settings,this),this.renderer.init()}this._setupMutationObserver(),this.renderer&&this.renderer.finalizeWrapperAttributes(),this.input.setAttribute("data-touchspin-injected","input")}static sanitizePartialSettings(t,e){let i={...t};if(Object.hasOwn(t,"step")){let a=Number(t.step);i.step=Number.isFinite(a)&&a>0?a:1}if(Object.hasOwn(t,"decimals")){let a=Number(t.decimals);i.decimals=Number.isFinite(a)&&a>=0?Math.floor(a):0}let s=Object.hasOwn(t,"min"),n=Object.hasOwn(t,"max");if(s)if(t.min===null||t.min===void 0||typeof t.min=="string"&&t.min==="")i.min=null;else{let a=Number(t.min);i.min=Number.isFinite(a)?a:null}if(n)if(t.max===null||t.max===void 0||typeof t.max=="string"&&t.max==="")i.max=null;else{let a=Number(t.max);i.max=Number.isFinite(a)?a:null}if(s&&n&&i.min!=null&&i.max!=null&&typeof i.min=="number"&&typeof i.max=="number"&&i.min>i.max){let a=i.min;i.min=i.max,i.max=a}if(Object.hasOwn(t,"stepinterval")){let a=Number(t.stepinterval);i.stepinterval=Number.isFinite(a)&&a>=0?a:m.stepinterval}if(Object.hasOwn(t,"stepintervaldelay")){let a=Number(t.stepintervaldelay);i.stepintervaldelay=Number.isFinite(a)&&a>=0?a:m.stepintervaldelay}return i}_initializeInput(){this._captureOriginalAttributes();let t=this.settings.initval??"";t!==""&&this.input.value===""&&(this.input.value=String(t)),this._updateAriaAttributes(),this._syncNativeAttributes(),this._checkValue(!1)}_sanitizeSettings(){let t=Number(this.settings.step);!Number.isFinite(t)||t<=0?this.settings.step=1:this.settings.step=t;let e=Number(this.settings.decimals);if(!Number.isFinite(e)||e<0?this.settings.decimals=0:this.settings.decimals=Math.floor(e),this.settings.min===null||this.settings.min===void 0||typeof this.settings.min=="string"&&this.settings.min==="")this.settings.min=null;else{let n=Number(this.settings.min);this.settings.min=Number.isFinite(n)?n:null}if(this.settings.max===null||this.settings.max===void 0||typeof this.settings.max=="string"&&this.settings.max==="")this.settings.max=null;else{let n=Number(this.settings.max);this.settings.max=Number.isFinite(n)?n:null}if(this.settings.min!==null&&this.settings.max!==null&&this.settings.min>this.settings.max){let n=this.settings.min;this.settings.min=this.settings.max,this.settings.max=n}let i=Number(this.settings.stepinterval);(!Number.isFinite(i)||i<0)&&(this.settings.stepinterval=m.stepinterval);let s=Number(this.settings.stepintervaldelay);(!Number.isFinite(s)||s<0)&&(this.settings.stepintervaldelay=m.stepintervaldelay),this._validateCallbacks(),this._checkCallbackPairing()}_validateCallbacks(){if(this.input.getAttribute("type")!=="number")return;let e=n=>n;if(!this.settings.callback_after_calculation||this.settings.callback_after_calculation.toString()===e.toString())return;let s=this.settings.callback_after_calculation("123.45");/^-?\d*\.?\d*$/.test(s)||(console.warn('TouchSpin: Detected formatting callback that adds non-numeric characters. Converting input from type="number" to type="text" to support formatting like "'+s+'". This ensures compatibility with custom formatting while maintaining full TouchSpin functionality. The original type will be restored when TouchSpin is destroyed.'),this._captureOriginalAttributes(),this.input.setAttribute("type","text"),this.input.removeAttribute("min"),this.input.removeAttribute("max"),this.input.removeAttribute("step"))}_captureOriginalAttributes(){if(this._originalAttributes!==null)return;let t=["role","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","min","max","step"];this._originalAttributes={type:this.input.getAttribute("type"),attributes:new Map},t.forEach(e=>{this._originalAttributes?.attributes.set(e,this.input.getAttribute(e))})}_restoreOriginalAttributes(){if(this._originalAttributes===null)return;let t=this.input.value;if(t&&this.settings.callback_before_calculation){let e=this.settings.callback_before_calculation(t);this.input.value=e}this._originalAttributes.type&&this.input.setAttribute("type",this._originalAttributes.type),this._originalAttributes.attributes.forEach((e,i)=>{e===null?this.input.removeAttribute(i):this.input.setAttribute(i,e)}),this._originalAttributes=null}_parseDataAttributes(t){let e={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalup:"vertical-up",verticaldown:"vertical-down",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"},i={};for(let[s,n]of Object.entries(e)){let a=`data-bts-${n}`;if(t.hasAttribute(a)){let o=t.getAttribute(a);i[s]=this._coerceAttributeValue(s,o??"")}}for(let s of["min","max","step"])if(t.hasAttribute(s)){let n=t.getAttribute(s);i[s]!==void 0&&console.warn(`Both "data-bts-${s}" and "${s}" attributes specified. Native attribute takes precedence.`,t),i[s]=this._coerceAttributeValue(s,n??"")}return i}_coerceAttributeValue(t,e){if(e==null)return e;if(["booster","mousewheel","verticalbuttons","focusablebuttons"].includes(t))return e==="true"||e===""||e===t;if(["min","max","step","decimals","stepinterval","stepintervaldelay","boostat","maxboostedstep","firstclickvalueifempty"].includes(t)){let i=parseFloat(e);return Number.isNaN(i)?e:i}return e}upOnce(){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let t=this.getValue(),e=this._nextValue("up",t);if(this.settings.max!==null&&t===this.settings.max){this.emit("max"),this.spinning&&this.direction==="up"&&this.stopSpin();return}this.settings.max!==null&&e===this.settings.max&&(this.emit("max"),this.spinning&&this.direction==="up"&&this.stopSpin()),this._setDisplay(e,!0)}downOnce(){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let t=this.getValue(),e=this._nextValue("down",t);if(this.settings.min!==null&&t===this.settings.min){this.emit("min"),this.spinning&&this.direction==="down"&&this.stopSpin();return}this.settings.min!==null&&e===this.settings.min&&(this.emit("min"),this.spinning&&this.direction==="down"&&this.stopSpin()),this._setDisplay(e,!0)}startUpSpin(){let t=this.getValue();if(this.settings.max!==null&&t===this.settings.max){this.emit("max");return}this._startSpin("up")}startDownSpin(){let t=this.getValue();if(this.settings.min!==null&&t===this.settings.min){this.emit("min");return}this._startSpin("down")}stopSpin(){this._clearSpinTimers(),this.spinning&&(this.direction==="up"?(this.emit("stopupspin"),this.emit("stopspin")):this.direction==="down"&&(this.emit("stopdownspin"),this.emit("stopspin"))),this.spinning=!1,this.direction=!1,this.spincount=0,this._currentStepSize=this.settings.step||1}updateSettings(t){let e={...this.settings},i=t||{},s=x.sanitizePartialSettings(i,e);Object.assign(this.settings,s),this._sanitizeSettings();let n=Number(this.settings.step||1);(s.step!==void 0||s.min!==void 0||s.max!==void 0)&&n!==1&&(this.settings.max!==null&&(this.settings.max=this._alignToStep(Number(this.settings.max),n,"down")),this.settings.min!==null&&(this.settings.min=this._alignToStep(Number(this.settings.min),n,"up"))),Object.keys(this.settings).forEach(a=>{if(e[a]!==this.settings[a]){let o=this._settingObservers.get(String(a));o&&o.forEach(u=>{try{u(this.settings[a],e[a])}catch(l){console.error("TouchSpin: Error in setting observer callback:",l)}})}}),this._updateAriaAttributes(),this._syncNativeAttributes(),this._checkValue(!0),this._currentStepSize=this.settings.step||1,this._checkCallbackPairing()}getValue(){let t=this.input.value,e=this.settings.replacementval??"";if(t===""&&e!==""&&(t=String(e)),t==="")return NaN;let i=this.settings.callback_before_calculation||(n=>n),s=parseFloat(i(String(t)));return Number.isNaN(s)?NaN:s}setValue(t){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let e=Number(t);if(!Number.isFinite(e))return;let i=this._applyConstraints(e),s=e!==i;this._setDisplay(i,!0,s,!1)}initDOMEventHandling(){this._findDOMElements(),this._attachDOMEventListeners()}registerTeardown(t){if(typeof t!="function")throw new Error("Teardown callback must be a function");return this._teardownCallbacks.push(t),()=>{let e=this._teardownCallbacks.indexOf(t);e>-1&&this._teardownCallbacks.splice(e,1)}}destroy(){this.input.removeAttribute("data-touchspin-injected"),this.stopSpin(),this.renderer?.teardown&&this.renderer.teardown(),this._detachDOMEventListeners(),this._teardownCallbacks.forEach(e=>{try{e()}catch(i){console.error("TouchSpin teardown callback error:",i)}}),this._teardownCallbacks.length=0,this._settingObservers.clear(),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),this._upButton=null,this._downButton=null,this._restoreOriginalAttributes();let t=this.input[h];t&&t===this&&delete this.input[h]}toPublicApi(){return{upOnce:this.upOnce.bind(this),downOnce:this.downOnce.bind(this),startUpSpin:this.startUpSpin.bind(this),startDownSpin:this.startDownSpin.bind(this),stopSpin:this.stopSpin.bind(this),updateSettings:this.updateSettings.bind(this),getValue:this.getValue.bind(this),setValue:this.setValue.bind(this),destroy:this.destroy.bind(this),initDOMEventHandling:this.initDOMEventHandling.bind(this),registerTeardown:this.registerTeardown.bind(this),attachUpEvents:this.attachUpEvents.bind(this),attachDownEvents:this.attachDownEvents.bind(this),observeSetting:this.observeSetting.bind(this)}}attachUpEvents(t){if(!t){console.warn("TouchSpin: attachUpEvents called with null element");return}this._upButton=t,t.addEventListener("mousedown",this._handleUpMouseDown),t.addEventListener("touchstart",this._handleUpMouseDown,{passive:!1}),this.settings.focusablebuttons&&(t.addEventListener("keydown",this._handleUpKeyDown),t.addEventListener("keyup",this._handleUpKeyUp)),this._updateButtonDisabledState()}attachDownEvents(t){if(!t){console.warn("TouchSpin: attachDownEvents called with null element");return}this._downButton=t,t.addEventListener("mousedown",this._handleDownMouseDown),t.addEventListener("touchstart",this._handleDownMouseDown,{passive:!1}),this.settings.focusablebuttons&&(t.addEventListener("keydown",this._handleDownKeyDown),t.addEventListener("keyup",this._handleDownKeyUp)),this._updateButtonDisabledState()}observeSetting(t,e){let i=String(t);this._settingObservers.has(i)||this._settingObservers.set(i,new Set);let s=this._settingObservers.get(i);return s.add(e),()=>s.delete(e)}emit(t,e,i=!1){let s=`touchspin.on.${t}`,n=new CustomEvent(s,{detail:e,bubbles:!0,cancelable:i});return!this.input.dispatchEvent(n)}_startSpin(t){if(this.input.disabled||this.input.hasAttribute("readonly")||this.spinning&&this.direction===t)return;if(this.spinning&&this.direction!==t&&this.stopSpin(),!this.spinning||this.direction!==t){if(this.spinning=!0,this.direction=t,this.spincount=0,this._currentStepSize=this.settings.step||1,this.emit("startspin"),t==="up"){if(this.emit("startupspin",void 0,!0)){this.spinning=!1,this.direction=!1;return}}else if(this.emit("startdownspin",void 0,!0)){this.spinning=!1,this.direction=!1;return}}t==="up"?this.upOnce():this.downOnce();let i=this.getValue();if(t==="up"&&this.settings.max!==null&&i===this.settings.max||t==="down"&&this.settings.min!==null&&i===this.settings.min)return;this._clearSpinTimers();let s=this.settings.stepintervaldelay||500,n=this.settings.stepinterval||100;this._spinDelayTimeout=setTimeout(()=>{this._spinDelayTimeout=null,this._spinIntervalTimer=setInterval(()=>{!this.spinning||this.direction!==t||this._spinStep(t)},n)},s)}_clearSpinTimers(){try{this._spinDelayTimeout&&clearTimeout(this._spinDelayTimeout)}catch{}try{this._spinIntervalTimer&&clearInterval(this._spinIntervalTimer)}catch{}this._spinDelayTimeout=null,this._spinIntervalTimer=null}_nextValue(t,e){let i=e;if(Number.isNaN(i))i=this._valueIfIsNaN();else{let s=this.settings.step||1,n=this.settings.maxboostedstep,a=s;if(this.settings.booster){let l=Math.max(1,parseInt(String(this.settings.boostat||10),10));a=2**Math.floor(this.spincount/l)*s}let o=a;n&&Number.isFinite(n)&&a>Number(n)&&(o=Number(n),i=Math.round(i/o)*o),o=Math.max(s,o);let u=this._currentStepSize??s;if(o<u&&(o=u),o>this._currentStepSize){let l=Math.floor(Math.log2(this._currentStepSize/s)),p=Math.floor(Math.log2(o/s)),b={currentLevel:l,newLevel:p,currentStep:this._currentStepSize,newStep:o,direction:t};if(this.emit("speedchange",b,!0))o=this._currentStepSize;else{let d=Number(b.newStep);Number.isFinite(d)&&d>=this.settings.step?o=Math.min(d,this.settings.maxboostedstep||Number.MAX_SAFE_INTEGER):o=this._currentStepSize}}this._currentStepSize=o,i=t==="up"?i+o:i-o}return this._applyConstraints(i)}_valueIfIsNaN(){if(typeof this.settings.firstclickvalueifempty=="number")return this.settings.firstclickvalueifempty;let t=typeof this.settings.min=="number"?this.settings.min:0,e=typeof this.settings.max=="number"?this.settings.max:t;return(t+e)/2}_applyConstraints(t){let e=this._forcestepdivisibility(t),i=this.settings.min??null,s=this.settings.max??null,n=e;return typeof i=="number"&&n<i&&(n=i),typeof s=="number"&&n>s&&(n=s),n}_getBoostedStep(){let t=this.settings.step||1;if(!this.settings.booster)return t;let e=Math.max(1,parseInt(String(this.settings.boostat||10),10)),i=2**Math.floor(this.spincount/e)*t,s=this.settings.maxboostedstep;if(s&&Number.isFinite(s)){let n=Number(s);i>n&&(i=n)}return Math.max(t,i)}_forcestepdivisibility(t){let e=this.settings.forcestepdivisibility||"round",i=this.settings.step||1,s=this.settings.decimals||0,n;switch(e){case"floor":n=Math.floor(t/i)*i;break;case"ceil":n=Math.ceil(t/i)*i;break;case"none":n=t;break;default:n=Math.round(t/i)*i;break}return Number(n.toFixed(s))}_alignToStep(t,e,i){if(e===0)return t;let s=1,n=e;for(;n*s%1!==0&&s<1e6;)s*=10;let a=Math.round(t*s),o=Math.round(e*s),u=a%o;return u===0?t:(i==="down"?a-u:a+(o-u))/s}_setDisplay(t,e,i=!1,s=!1){let n=String(this.input.value??""),a=this._formatDisplay(t);return this.input.value=a,this._updateAriaAttributes(),e&&(s?i:i||n!==a)&&this.input.dispatchEvent(new Event("change",{bubbles:!0})),a}_formatDisplay(t){let e=this.settings.decimals||0,i=this.settings.callback_after_calculation||(n=>n),s=Number(t).toFixed(e);return i(s)}_spinStep(t){this.spincount++,t==="up"?this.upOnce():this.downOnce()}_checkValue(t){let e=this.getValue();if(!Number.isFinite(e))return;let i=this._applyConstraints(e),s=e!==i;this._setDisplay(i,!!t,s)}_updateAriaAttributes(){let t=this.input;t.getAttribute("role")!=="spinbutton"&&t.setAttribute("role","spinbutton");let e=this.settings.min??null,i=this.settings.max??null;typeof e=="number"?t.setAttribute("aria-valuemin",String(e)):t.removeAttribute("aria-valuemin"),typeof i=="number"?t.setAttribute("aria-valuemax",String(i)):t.removeAttribute("aria-valuemax");let s=t.value,n=this.settings.callback_before_calculation||(o=>o),a=parseFloat(n(String(s)));Number.isFinite(a)?t.setAttribute("aria-valuenow",String(a)):t.removeAttribute("aria-valuenow"),t.setAttribute("aria-valuetext",String(s))}_syncNativeAttributes(){if(this.input.getAttribute("type")==="number"){let t=this.settings.min??null;typeof t=="number"&&Number.isFinite(t)?this.input.setAttribute("min",String(t)):this.input.removeAttribute("min");let e=this.settings.max??null;typeof e=="number"&&Number.isFinite(e)?this.input.setAttribute("max",String(e)):this.input.removeAttribute("max");let i=this.settings.step;typeof i=="number"&&Number.isFinite(i)&&i>0?this.input.setAttribute("step",String(i)):this.input.removeAttribute("step")}}_syncSettingsFromNativeAttributes(){let t=this.input.getAttribute("min"),e=this.input.getAttribute("max"),i=this.input.getAttribute("step"),s=!1,n={};if(t!==null){let a=t===""?null:parseFloat(t),o=a!==null&&Number.isFinite(a)?a:null;o!==this.settings.min&&(n.min=o,s=!0)}else this.settings.min!==null&&(n.min=null,s=!0);if(e!==null){let a=e===""?null:parseFloat(e),o=a!==null&&Number.isFinite(a)?a:null;o!==this.settings.max&&(n.max=o,s=!0)}else this.settings.max!==null&&(n.max=null,s=!0);if(i!==null){let a=i===""?void 0:parseFloat(i),o=a!==void 0&&Number.isFinite(a)&&a>0?a:void 0;o!==this.settings.step&&(n.step=o??1,s=!0)}else this.settings.step!==1&&(n.step=1,s=!0);s&&this.updateSettings(n)}_findDOMElements(){let t=this.input.parentElement;for(;t&&!t.hasAttribute("data-touchspin-injected");)t=t.parentElement;this._wrapper=t}_attachDOMEventListeners(){document.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("mouseleave",this._handleMouseUp),document.addEventListener("touchend",this._handleMouseUp),window.addEventListener("change",this._handleWindowChangeCapture,!0),this.input.addEventListener("keydown",this._handleKeyDown),this.input.addEventListener("keyup",this._handleKeyUp),this.input.addEventListener("wheel",this._handleWheel)}_detachDOMEventListeners(){document.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("mouseleave",this._handleMouseUp),document.removeEventListener("touchend",this._handleMouseUp),window.removeEventListener("change",this._handleWindowChangeCapture,!0),this.input.removeEventListener("keydown",this._handleKeyDown),this.input.removeEventListener("keyup",this._handleKeyUp),this.input.removeEventListener("wheel",this._handleWheel)}_handleUpMouseDown(t){t.preventDefault(),this.startUpSpin()}_handleDownMouseDown(t){t.preventDefault(),this.startDownSpin()}_handleMouseUp(t){this.stopSpin()}_handleUpKeyDown(t){if(t.keyCode===13||t.keyCode===32){if(t.preventDefault(),t.repeat)return;this.startUpSpin()}}_handleUpKeyUp(t){(t.keyCode===13||t.keyCode===32)&&this.stopSpin()}_handleDownKeyDown(t){if(t.keyCode===13||t.keyCode===32){if(t.preventDefault(),t.repeat)return;this.startDownSpin()}}_handleDownKeyUp(t){(t.keyCode===13||t.keyCode===32)&&this.stopSpin()}_handleWindowChangeCapture(t){let e=t.target;if(!e||e!==this.input)return;let i=this.getValue();if(!Number.isFinite(i))return;let s=this._applyConstraints(i);s!==i&&this._setDisplay(s,!1)}_handleKeyDown(t){switch(t.key){case"ArrowUp":if(t.preventDefault(),t.repeat)return;this.startUpSpin();break;case"ArrowDown":if(t.preventDefault(),t.repeat)return;this.startDownSpin();break;case"Enter":this._checkValue(!1);break}}_handleKeyUp(t){(t.key==="ArrowUp"||t.key==="ArrowDown")&&this.stopSpin()}_handleWheel(t){this.settings.mousewheel&&document.activeElement===this.input&&(t.preventDefault(),t.deltaY<0?this.upOnce():t.deltaY>0&&this.downOnce())}_setupMutationObserver(){typeof MutationObserver<"u"&&(this._mutationObserver=new MutationObserver(t=>{t.forEach(e=>{e.type==="attributes"&&(e.attributeName==="disabled"||e.attributeName==="readonly"?this._updateButtonDisabledState():(e.attributeName==="min"||e.attributeName==="max"||e.attributeName==="step")&&this._syncSettingsFromNativeAttributes())})}),this._mutationObserver.observe(this.input,{attributes:!0,attributeFilter:["disabled","readonly","min","max","step"]}))}_updateButtonDisabledState(){let t=this.input.disabled||this.input.hasAttribute("readonly");this._upButton&&(this._upButton.disabled=t),this._downButton&&(this._downButton.disabled=t),t&&this.stopSpin()}_checkCallbackPairing(){let t=s=>s,e=this.settings.callback_before_calculation&&this.settings.callback_before_calculation.toString()!==t.toString(),i=this.settings.callback_after_calculation&&this.settings.callback_after_calculation.toString()!==t.toString();if(e&&!i?console.warn("TouchSpin: callback_before_calculation is defined but callback_after_calculation is missing. These callbacks should be used together - one removes formatting, the other adds it back."):!e&&i&&console.warn("TouchSpin: callback_after_calculation is defined but callback_before_calculation is missing. These callbacks should be used together - one removes formatting, the other adds it back."),e&&i){let s=[],n=this.settings.decimals||0,a=p=>p.toFixed(n),o=this.settings.min!==null&&this.settings.min!==void 0,u=this.settings.max!==null&&this.settings.max!==void 0;o&&u?s.push(a(this.settings.min),a(this.settings.max)):o?s.push(a(this.settings.min)):u?s.push(a(this.settings.max)):s.push(n>0?"50.55":"50");let l=[];for(let p of s){let b=this.settings.callback_after_calculation?.(p);if(b===void 0)continue;let d=this.settings.callback_before_calculation?.(b);d!==void 0&&d!==p&&l.push(`"${p}" \u2192 after \u2192 "${b}" \u2192 before \u2192 "${d}" (expected "${p}")`)}l.length>0&&console.warn(`TouchSpin: Callbacks are not properly paired - round-trip test failed:
`+l.join(`
`)+`
callback_before_calculation must reverse what callback_after_calculation does. For example, if after adds " USD", before must strip " USD".`)}}};function N(r,t){if(!r||r.nodeName!=="INPUT")return console.warn("Must be an input."),null;if(t!==void 0){r[h]&&(console.warn("TouchSpin: Destroying existing instance and reinitializing. Consider using updateSettings() instead."),r[h]?.destroy());let e=new E(r,t);return r[h]=e,e.initDOMEventHandling(),e.toPublicApi()}if(!r[h]){let e=new E(r,{});return r[h]=e,e.initDOMEventHandling(),e.toPublicApi()}return r[h].toPublicApi()}var c=Object.freeze({MIN:"min",MAX:"max",START_SPIN:"startspin",START_UP:"startupspin",START_DOWN:"startdownspin",STOP_SPIN:"stopspin",STOP_UP:"stopupspin",STOP_DOWN:"stopdownspin"});function S(r){return{"vertical-buttons":"verticalbuttons","vertical-up":"verticalup","vertical-down":"verticaldown","vertical-up-class":"verticalupclass","vertical-down-class":"verticaldownclass","button-up-class":"buttonup_class","button-down-class":"buttondown_class","button-up-txt":"buttonup_txt","button-down-txt":"buttondown_txt","prefix-class":"prefix_extraclass","postfix-class":"postfix_extraclass","force-step-divisibility":"forcestepdivisibility","step-interval":"stepinterval","step-interval-delay":"stepintervaldelay","boost-at":"boostat","max-boosted-step":"maxboostedstep","mouse-wheel":"mousewheel","init-val":"initval","replacement-val":"replacementval","focusable-buttons":"focusablebuttons"}[r]||r}function y(r,t){if(r===null)return null;if(r==="")return!0;if(["verticalbuttons","mousewheel","booster","focusablebuttons"].includes(t))return r==="true"||r==="";if(["min","max","step","decimals","stepinterval","stepintervaldelay","boostat","maxboostedstep","firstclickvalueifempty"].includes(t)){let s=Number(r);return Number.isNaN(s)?null:s}return r}function D(r){let t={};for(let e of Array.from(r.attributes)){if(e.name==="is"||e.name.startsWith("data-testid"))continue;let i=S(e.name),s=y(e.value,i);s!==null&&(t[i]=s)}return t}var O=["min","max","step","value","decimals","prefix","postfix","vertical-buttons","vertical-up","vertical-down","button-up-txt","button-down-txt","mouse-wheel","disabled","readonly","renderer","force-step-divisibility","step-interval","step-interval-delay","booster","boost-at","max-boosted-step"];var et={[c.MIN]:"touchspin-min",[c.MAX]:"touchspin-max",[c.START_SPIN]:"touchspin-start-spin",[c.START_UP]:"touchspin-start-up",[c.START_DOWN]:"touchspin-start-down",[c.STOP_SPIN]:"touchspin-stop-spin",[c.STOP_UP]:"touchspin-stop-up",[c.STOP_DOWN]:"touchspin-stop-down"};function k(r,t){let e=[];Object.entries({"touchspin.on.min":"touchspin-min","touchspin.on.max":"touchspin-max","touchspin.on.startspin":"touchspin-start-spin","touchspin.on.startupspin":"touchspin-start-up","touchspin.on.startdownspin":"touchspin-start-down","touchspin.on.stopspin":"touchspin-stop-spin","touchspin.on.stopupspin":"touchspin-stop-up","touchspin.on.stopdownspin":"touchspin-stop-down"}).forEach(([n,a])=>{let o=l=>{let p=new CustomEvent(a,{detail:{value:r.getValue(),instance:r,originalEvent:l},bubbles:!0,cancelable:!0});t.dispatchEvent(p)},u=t.querySelector("input");u&&(u.addEventListener(n,o),e.push(()=>u.removeEventListener(n,o)))});let s=t.querySelector("input");if(s){let n=a=>{let o=new CustomEvent("touchspin-change",{detail:{value:a.target.value,originalEvent:a,instance:r},bubbles:!0,cancelable:!0});t.dispatchEvent(o)};s.addEventListener("change",n),e.push(()=>s.removeEventListener("change",n))}return e}var g=class extends HTMLElement{static get observedAttributes(){return O.filter(t=>t!=="renderer")}constructor(t){super(),this._touchspin=null,this._input=null,this._eventUnsubscribers=[],this._isConnected=!1,this._renderer=t}setRenderer(t){this._renderer=t}connectedCallback(){this._isConnected=!0,this._initialize()}disconnectedCallback(){this._isConnected=!1,this._cleanup()}attributeChangedCallback(t,e,i){if(!this._isConnected||!this._touchspin)return;if(t==="value"){i!==e&&this._touchspin.setValue(i??"");return}if(t==="disabled"){this._input&&(this._input.disabled=i!==null);return}if(t==="readonly"){this._input&&(this._input.readOnly=i!==null);return}let s=S(t),n=y(i,s);this._touchspin?.updateSettings&&this._touchspin.updateSettings({[s]:n})}_initialize(){if(this._input=this.querySelector('input[type="number"]')||this.querySelector("input"),!this._input){this._input=document.createElement("input"),this._input.type="number";let e=this.getAttribute("name");e&&this._input.setAttribute("name",e),this.appendChild(this._input)}let t=D(this);this._renderer&&(t.renderer=this._renderer),this._applyInputAttributes(),this._touchspin=N(this._input,t),this._touchspin&&(this._eventUnsubscribers=k(this._touchspin,this))}_applyInputAttributes(){if(!this._input)return;let t=this.getAttribute("value");t!==null&&(this._input.value=t),this.hasAttribute("disabled")&&(this._input.disabled=!0),this.hasAttribute("readonly")&&(this._input.readOnly=!0);let e=this.getAttribute("name");e!==null&&this._input.setAttribute("name",e);let i=this.getAttribute("data-testid");i!==null&&this._input.setAttribute("data-testid",`${i}-input`);let s=["min","max","step","placeholder"];for(let n of s){let a=this.getAttribute(n);a!==null&&this._input.setAttribute(n,String(a))}}_cleanup(){this._eventUnsubscribers.forEach(t=>t()),this._eventUnsubscribers=[],this._touchspin?.destroy&&this._touchspin.destroy(),this._touchspin=null}get value(){return this._touchspin?this._touchspin.getValue():this._input?this._input.value:""}set value(t){this.setAttribute("value",String(t))}get min(){return this.getAttribute("min")}set min(t){t===null?this.removeAttribute("min"):this.setAttribute("min",String(t))}get max(){return this.getAttribute("max")}set max(t){t===null?this.removeAttribute("max"):this.setAttribute("max",String(t))}get step(){return this.getAttribute("step")}set step(t){t===null?this.removeAttribute("step"):this.setAttribute("step",String(t))}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get readonly(){return this.hasAttribute("readonly")}set readonly(t){t?this.setAttribute("readonly",""):this.removeAttribute("readonly")}upOnce(){this._touchspin?.upOnce&&this._touchspin.upOnce()}downOnce(){this._touchspin?.downOnce&&this._touchspin.downOnce()}startUpSpin(){this._touchspin?.startUpSpin&&this._touchspin.startUpSpin()}startDownSpin(){this._touchspin?.startDownSpin&&this._touchspin.startDownSpin()}stopSpin(){this._touchspin?.stopSpin&&this._touchspin.stopSpin()}updateSettings(t){this._touchspin?.updateSettings&&this._touchspin.updateSettings(t)}getTouchSpinInstance(){return this._touchspin}destroy(){this._cleanup()}};var v=null;function C(r,t){let e="touchspin-input";if(customElements.get(e)){v&&v!==t&&console.warn(`[TouchSpin] Custom element "${e}" is already defined with renderer "${v}". Skipping redefinition with "${t}". Only one renderer can be used per page.`);return}class s extends g{constructor(){super(r)}}customElements.define(e,s),v=t}C(T,"vanilla");return B(z);})();
