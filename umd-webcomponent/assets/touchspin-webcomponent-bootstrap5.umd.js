"use strict";var TouchSpinWCBootstrap5=(()=>{var A=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var L=(e,t)=>{for(var i in t)A(e,i,{get:t[i],enumerable:!0})},F=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of R(t))!B.call(e,n)&&n!==i&&A(e,n,{get:()=>t[n],enumerable:!(s=U(t,n))||s.enumerable});return e};var V=e=>F(A({},"__esModule",{value:!0}),e);var K={};L(K,{TouchSpinInput:()=>_});var S="data-testid",W="data-touchspin-injected",j=class{constructor(e,t,i){this.wrapper=null,this.wrapperType="wrapper",this.input=e,this.settings=t,this.core=i}finalizeWrapperAttributes(){let e=this.input.getAttribute(S);e&&!this.wrapper?.hasAttribute(S)&&this.wrapper?.setAttribute(S,`${e}-wrapper`),this.wrapper?.setAttribute(W,this.wrapperType)}getUpButtonTestId(){return this.buildDataTestId("up")}getDownButtonTestId(){return this.buildDataTestId("down")}getPrefixTestId(){return this.buildDataTestId("prefix")}getPostfixTestId(){return this.buildDataTestId("postfix")}filterRendererSettings(e,t=this.settings){let i={};for(let s in e)Object.hasOwn(t,s)&&(i[s]=t[s]);return i}buildDataTestId(e){let t=this.input.getAttribute(S);return t?` data-testid="${t}-${e}"`:""}},z=j;var $=class extends z{constructor(){super(...arguments),this.undoStack=[],this.specialElements=new Map}registerSpecialElement(e,t){this.specialElements.set(e,t)}createTrackedElement(e){let t=document.createElement(e);return this.undoStack.push({type:"CREATE_ELEMENT",element:t}),t}trackAddClass(e,t){e.classList.add(t),this.undoStack.push({type:"ADD_CLASS",element:e,className:t})}trackRemoveClass(e,t){e.classList.remove(t),this.undoStack.push({type:"REMOVE_CLASS",element:e,className:t})}trackSetAttribute(e,t,i){let s=e.getAttribute(t);e.setAttribute(t,i),this.undoStack.push({type:"SET_ATTRIBUTE",element:e,name:t,originalValue:s})}trackAddAttribute(e,t,i){e.setAttribute(t,i)}trackMoveElement(e,t,i=null){let s=e.parentElement,n=e.nextSibling;i?t.insertBefore(e,i):t.appendChild(e),s&&this.undoStack.push({type:"MOVE_ELEMENT",element:e,originalParent:s,originalNextSibling:n})}finalizeWrapperAttributes(){let e=this.input.getAttribute("data-testid");e&&!this.wrapper?.hasAttribute("data-testid")&&this.trackAddAttribute(this.wrapper,"data-testid",`${e}-wrapper`),this.trackSetAttribute(this.wrapper,"data-touchspin-injected",this.wrapperType)}teardown(){for(;this.undoStack.length>0;){let e=this.undoStack.pop();switch(e.type){case"CREATE_ELEMENT":e.element.remove();break;case"ADD_CLASS":e.element.classList.remove(e.className);break;case"REMOVE_CLASS":e.element.classList.add(e.className);break;case"SET_ATTRIBUTE":e.originalValue===null?e.element.removeAttribute(e.name):e.element.setAttribute(e.name,e.originalValue);break;case"MOVE_ELEMENT":e.originalNextSibling?.parentElement?e.originalParent.insertBefore(e.element,e.originalNextSibling):e.originalParent.appendChild(e.element);break}}this.specialElements.clear()}},y=$;var G=Object.freeze({buttonup_txt:{kind:"string"},buttondown_txt:{kind:"string"},buttonup_class:{kind:"string"},buttondown_class:{kind:"string"},verticalbuttons:{kind:"boolean"},verticalup:{kind:"string"},verticaldown:{kind:"string"},verticalupclass:{kind:"string"},verticaldownclass:{kind:"string"},prefix:{kind:"string"},postfix:{kind:"string"},prefix_extraclass:{kind:"string"},postfix_extraclass:{kind:"string"}}),u={FORM_CONTROL:"form-control",INPUT_GROUP:"input-group",INPUT_GROUP_TEXT:"input-group-text",BOOTSTRAP_TOUCHSPIN:"bootstrap-touchspin",BTN_VERTICAL:"input-group-btn-vertical",DEFAULT_BUTTON:"btn btn-outline-secondary"},h={UP_BUTTON:'[data-touchspin-injected="up"]',DOWN_BUTTON:'[data-touchspin-injected="down"]',PREFIX:'[data-touchspin-injected="prefix"]',POSTFIX:'[data-touchspin-injected="postfix"]',VERTICAL_WRAPPER:'[data-touchspin-injected="vertical-wrapper"]'},N={UP:"+",DOWN:"\u2212"},v={UP:"up",DOWN:"down",PREFIX:"prefix",POSTFIX:"postfix",VERTICAL_WRAPPER:"vertical-wrapper"},H=class extends y{constructor(...e){super(...e),this.opts={},this.prefixEl=null,this.postfixEl=null,this.formControlAdded=!1;let[t]=e;this.floatingContainer=t.closest(".form-floating"),this.floatingLabel=this.floatingContainer?.querySelector("label"),this.initialInputGroup=t.closest(`.${u.INPUT_GROUP}`)}init(){this.registerSpecialElement("input",this.input),this.initialInputGroup&&this.registerSpecialElement("inputGroup",this.initialInputGroup),this.floatingContainer&&this.registerSpecialElement("floatingContainer",this.floatingContainer),this.floatingLabel&&this.registerSpecialElement("floatingLabel",this.floatingLabel);let e=this.floatingContainer||this.input;this.registerSpecialElement("inputContainer",e),this.initializeOptions(),this.resetElementReferences(),this.handleFloatingMargins(),this.ensureFormControlClass(),this.buildAndAttachDOM(),this.registerSettingObservers()}teardown(){this.restoreFormControlClass(),super.teardown()}initializeOptions(){this.opts=this.filterRendererSettings(G)}resetElementReferences(){this.prefixEl=null,this.postfixEl=null}ensureFormControlClass(){this.input.classList.contains(u.FORM_CONTROL)||(this.trackAddClass(this.input,u.FORM_CONTROL),this.formControlAdded=!0)}restoreFormControlClass(){this.formControlAdded&&(this.trackRemoveClass(this.input,u.FORM_CONTROL),this.formControlAdded=!1)}handleFloatingMargins(){if(!this.floatingContainer)return;let e=Array.from(this.floatingContainer.classList).filter(i=>/^m[tblrxy]?-\d+$/.test(i)),t=this.floatingContainer;e.forEach(i=>{this.trackRemoveClass(t,i),t.dataset.movedMargins?t.dataset.movedMargins+=` ${i}`:t.dataset.movedMargins=i})}buildInputGroup(){if(this.floatingContainer&&this.initialInputGroup)return this.buildFloatingLabelInInputGroup();if(this.floatingContainer&&this.floatingLabel)return this.buildBasicFloatingLabel();this.floatingContainer&&this.extractInputFromFloatingContainer();let t=this.input.closest(`.${u.INPUT_GROUP}`)??this.initialInputGroup;return t?this.buildAdvancedInputGroup(t):this.buildBasicInputGroup()}extractInputFromFloatingContainer(){if(!this.floatingContainer||this.input.parentElement!==this.floatingContainer)return;let e=this.floatingContainer.parentElement;e&&this.trackMoveElement(this.input,e,this.floatingContainer.nextSibling)}buildBasicInputGroup(){let e=this.detectInputGroupSize(),t=this.createInputGroupWrapper(e);return this.appendElementsToWrapper(t),this.insertWrapperAndInput(t),this.positionInputWithinWrapper(t),t}buildBasicFloatingLabel(){let e=this.detectInputGroupSize(),t=this.createInputGroupWrapper(e);return this.floatingContainer?.parentElement&&this.trackMoveElement(t,this.floatingContainer.parentElement,this.floatingContainer),this.opts.verticalbuttons||this.trackMoveElement(this.createDownButton(),t),this.opts.prefix&&this.trackMoveElement(this.createPrefixElement(),t),this.floatingContainer&&this.trackMoveElement(this.floatingContainer,t),this.opts.postfix&&this.trackMoveElement(this.createPostfixElement(),t),this.opts.verticalbuttons?this.trackMoveElement(this.createVerticalButtonWrapper(),t):this.trackMoveElement(this.createUpButton(),t),t}buildFloatingLabelInInputGroup(){let e=this.initialInputGroup;if(this.trackAddClass(e,u.BOOTSTRAP_TOUCHSPIN),this.wrapperType="wrapper-advanced",this.opts.verticalbuttons||this.trackMoveElement(this.createDownButton(),e,this.floatingContainer),this.opts.prefix&&this.trackMoveElement(this.createPrefixElement(),e,this.floatingContainer),this.opts.postfix){let t=this.floatingContainer?.nextSibling??null;this.trackMoveElement(this.createPostfixElement(),e,t)}if(this.opts.verticalbuttons){let t=this.floatingContainer?.nextSibling??null;this.trackMoveElement(this.createVerticalButtonWrapper(),e,t)}else{let t=this.floatingContainer?.nextSibling??null;this.trackMoveElement(this.createUpButton(),e,t)}return this.storeElementReferences(e),e}buildAdvancedInputGroup(e){return this.trackAddClass(e,u.BOOTSTRAP_TOUCHSPIN),this.wrapperType="wrapper-advanced",this.insertElementsIntoExistingGroup(e),this.storeElementReferences(e),e}createInputGroupWrapper(e){let t=this.createTrackedElement("div");return this.trackAddClass(t,u.INPUT_GROUP),e&&this.trackAddClass(t,e),this.trackAddClass(t,u.BOOTSTRAP_TOUCHSPIN),t}appendElementsToWrapper(e){this.opts.verticalbuttons||this.trackMoveElement(this.createDownButton(),e),this.opts.prefix&&this.trackMoveElement(this.createPrefixElement(),e),this.opts.postfix&&this.trackMoveElement(this.createPostfixElement(),e),this.opts.verticalbuttons?this.trackMoveElement(this.createVerticalButtonWrapper(),e):this.trackMoveElement(this.createUpButton(),e)}insertWrapperAndInput(e){this.input.parentElement&&this.trackMoveElement(e,this.input.parentElement,this.input)}positionInputWithinWrapper(e){let t=this.findInputInsertionPoint(e);this.trackMoveElement(this.input,e,t)}findInputInsertionPoint(e){return this.opts.verticalbuttons?this.findVerticalInsertionPoint(e):this.findHorizontalInsertionPoint(e)}findVerticalInsertionPoint(e){let t=e.querySelector(h.PREFIX),i=e.querySelector(h.POSTFIX),s=e.querySelector(h.VERTICAL_WRAPPER);return t?t.nextSibling:i||s}findHorizontalInsertionPoint(e){let t=e.querySelector(h.PREFIX),i=e.querySelector(h.POSTFIX),s=e.querySelector(h.UP_BUTTON);return t?t.nextSibling:i||s}insertElementsIntoExistingGroup(e){if(this.ensureInputInGroup(e),this.opts.verticalbuttons||this.trackMoveElement(this.createDownButton(),e,this.input),this.opts.prefix&&this.trackMoveElement(this.createPrefixElement(),e,this.input),this.opts.postfix&&this.trackMoveElement(this.createPostfixElement(),e,this.input.nextSibling),this.opts.verticalbuttons){let t=this.opts.postfix?e.querySelector(h.POSTFIX)?.nextSibling??null:this.input.nextSibling;this.trackMoveElement(this.createVerticalButtonWrapper(),e,t)}else{let t=this.opts.postfix?e.querySelector(h.POSTFIX)?.nextSibling??null:this.input.nextSibling;this.trackMoveElement(this.createUpButton(),e,t)}}ensureInputInGroup(e){this.input.parentElement!==e&&this.trackMoveElement(this.input,e)}createButton(e,t=!1){let i=this.createTrackedElement("button");this.trackAddAttribute(i,"type","button"),i.tabIndex=this.settings.focusablebuttons?0:-1,this.trackAddAttribute(i,"data-touchspin-injected",e),this.trackAddAttribute(i,"aria-label",e==="up"?"Increase value":"Decrease value");let s=this.input.getAttribute("data-testid");s&&this.trackAddAttribute(i,"data-testid",`${s}-${e}`),i.className=this.getButtonClass(e,t);let n=this.getButtonSetting(e,t),r=this.getButtonFallback(e);return this.applyButtonLabel(i,n,r),i}createUpButton(){return this.createButton("up")}createDownButton(){return this.createButton("down")}createPrefixElement(){let e=this.createTrackedElement("span");e.className=this.buildClasses([u.INPUT_GROUP_TEXT,"bootstrap-touchspin-prefix",this.opts.prefix_extraclass]),this.trackAddAttribute(e,"data-touchspin-injected",v.PREFIX),e.textContent=this.opts.prefix;let t=this.input.getAttribute("data-testid");return t&&this.trackAddAttribute(e,"data-testid",`${t}-prefix`),e}createPostfixElement(){let e=this.createTrackedElement("span");e.className=this.buildClasses([u.INPUT_GROUP_TEXT,"bootstrap-touchspin-postfix",this.opts.postfix_extraclass]),this.trackAddAttribute(e,"data-touchspin-injected",v.POSTFIX),e.textContent=this.opts.postfix;let t=this.input.getAttribute("data-testid");return t&&this.trackAddAttribute(e,"data-testid",`${t}-postfix`),e}createVerticalButtonWrapper(){let e=this.createTrackedElement("span");e.className=this.buildClasses([u.INPUT_GROUP_TEXT,"bootstrap-touchspin-vertical-button-wrapper"]),this.trackAddAttribute(e,"data-touchspin-injected",v.VERTICAL_WRAPPER);let t=this.createTrackedElement("span");return t.className=u.BTN_VERTICAL,this.trackMoveElement(this.createButton("up",!0),t),this.trackMoveElement(this.createButton("down",!0),t),this.trackMoveElement(t,e),e}buildClasses(e){return e.filter(Boolean).join(" ")}getButtonClass(e,t=!1){let i=e==="up"?this.opts.buttonup_class||u.DEFAULT_BUTTON:this.opts.buttondown_class||u.DEFAULT_BUTTON,s=t&&e==="up"?this.opts.verticalupclass||u.DEFAULT_BUTTON:t&&e==="down"?this.opts.verticaldownclass||u.DEFAULT_BUTTON:"";return this.buildClasses([i,s,`bootstrap-touchspin-${e}`])}getButtonSetting(e,t){return t?e==="up"?this.opts.verticalup:this.opts.verticaldown:e==="up"?this.opts.buttonup_txt:this.opts.buttondown_txt}getButtonFallback(e){return e==="up"?N.UP:N.DOWN}detectInputGroupSize(){let e=this.input.className;return e.includes("form-control-sm")?"input-group-sm":e.includes("form-control-lg")?"input-group-lg":""}findInjectedElement(e){return this.wrapper?.querySelector(`[data-touchspin-injected="${e}"]`)}buildAndAttachDOM(){this.initializeOptions(),this.wrapper=this.buildInputGroup(),this.applyMovedMargins(),this.storeElementReferences(this.wrapper),this.attachEventsToButtons()}applyMovedMargins(){if(!this.floatingContainer)return;let e=this.floatingContainer.dataset.movedMargins;e&&(e.split(" ").forEach(t=>{this.trackAddClass(this.wrapper,t)}),delete this.floatingContainer.dataset.movedMargins)}storeElementReferences(e){this.prefixEl=e.querySelector(h.PREFIX),this.postfixEl=e.querySelector(h.POSTFIX)}attachEventsToButtons(){let e=this.wrapper?.querySelector(h.UP_BUTTON),t=this.wrapper?.querySelector(h.DOWN_BUTTON);this.core.attachUpEvents(e),this.core.attachDownEvents(t)}registerSettingObservers(){this.core.observeSetting("prefix",e=>this.updatePrefix(e)),this.core.observeSetting("postfix",e=>this.updatePostfix(e)),this.core.observeSetting("buttonup_class",e=>this.updateButtonClass("up",e)),this.core.observeSetting("buttondown_class",e=>this.updateButtonClass("down",e)),this.core.observeSetting("verticalupclass",e=>this.updateVerticalButtonClass("up",e)),this.core.observeSetting("verticaldownclass",e=>this.updateVerticalButtonClass("down",e)),this.core.observeSetting("verticalup",e=>this.updateVerticalButtonText("up",e)),this.core.observeSetting("verticaldown",e=>this.updateVerticalButtonText("down",e)),this.core.observeSetting("buttonup_txt",e=>this.updateButtonText("up",e)),this.core.observeSetting("buttondown_txt",e=>this.updateButtonText("down",e)),this.core.observeSetting("prefix_extraclass",()=>this.updatePrefixClasses()),this.core.observeSetting("postfix_extraclass",()=>this.updatePostfixClasses()),this.core.observeSetting("verticalbuttons",e=>this.handleVerticalButtonsChange(e)),this.core.observeSetting("focusablebuttons",e=>this.updateButtonFocusability(e))}updatePrefix(e){e&&e!==""?this.prefixEl?(this.prefixEl.textContent=e,this.prefixEl.style.display="",this.updatePrefixClasses()):this.rebuildDOM():this.prefixEl&&this.rebuildDOM()}updatePostfix(e){e&&e!==""?this.postfixEl?(this.postfixEl.textContent=e,this.postfixEl.style.display="",this.updatePostfixClasses()):this.rebuildDOM():this.postfixEl&&this.rebuildDOM()}updateButtonClass(e,t){let i=this.findInjectedElement(e);i&&(i.className=this.buildClasses([t||u.DEFAULT_BUTTON,`bootstrap-touchspin-${e}`]))}updateVerticalButtonClass(e,t){let s=this.findInjectedElement(v.VERTICAL_WRAPPER)?.querySelector(`[data-touchspin-injected="${e}"]`);if(s){this.initializeOptions();let n=e==="up"?this.opts.buttonup_class??u.DEFAULT_BUTTON:this.opts.buttondown_class??u.DEFAULT_BUTTON;s.className=this.buildClasses([n,t??u.DEFAULT_BUTTON,`bootstrap-touchspin-${e}`])}}updateVerticalButtonText(e,t){let i=this.findInjectedElement(v.VERTICAL_WRAPPER),s=i?i.querySelector(`[data-touchspin-injected="${e}"]`):null;if(s){this.initializeOptions();let n=this.getButtonFallback(e),r=t??this.getButtonSetting(e,!0);this.applyButtonLabel(s,r,n)}}updateButtonText(e,t){let i=this.findInjectedElement(e);if(i){this.initializeOptions();let s=this.getButtonFallback(e),n=t??this.getButtonSetting(e,!1);this.applyButtonLabel(i,n,s)}}updatePrefixClasses(){this.prefixEl&&(this.initializeOptions(),this.prefixEl.className=this.buildClasses([u.INPUT_GROUP_TEXT,"bootstrap-touchspin-prefix",this.opts.prefix_extraclass]))}updatePostfixClasses(){this.postfixEl&&(this.initializeOptions(),this.postfixEl.className=this.buildClasses([u.INPUT_GROUP_TEXT,"bootstrap-touchspin-postfix",this.opts.postfix_extraclass]))}updateButtonFocusability(e){if(!this.wrapper)return;let t=this.wrapper.querySelectorAll(`${h.UP_BUTTON}, ${h.DOWN_BUTTON}`),i=e?"0":"-1";t.forEach(s=>{s.setAttribute("tabindex",i)})}handleVerticalButtonsChange(e){this.rebuildDOM()}rebuildDOM(){this.teardown(),this.resetStateAfterRemoval(),this.buildAndAttachDOM(),this.finalizeWrapperAttributes()}resetStateAfterRemoval(){this.wrapper=null,this.prefixEl=null,this.postfixEl=null}applyButtonLabel(e,t,i){let{value:s,isHtml:n}=this.resolveButtonContent(t,i);if(n){e.innerHTML=s;return}e.textContent=s}resolveButtonContent(e,t){if(e==null)return{value:t,isHtml:!1};let i=e.trim();if(i==="")return{value:t,isHtml:!1};if(this.containsHtml(i))return{value:i,isHtml:!0};let s=this.decodeHtml(i);return s===void 0||s===""?{value:t,isHtml:!1}:{value:s,isHtml:!1}}containsHtml(e){return/<\/?[a-zA-Z][^>]{0,200}>/.test(e)}decodeHtml(e){if(typeof document>"u"||!e.includes("&"))return e;let t=document.createElement("textarea");return t.innerHTML=e,t.value}},O=H;var g={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,forcestepdivisibility:"round",stepinterval:100,stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"\u2212",verticalupclass:null,verticaldownclass:null,focusablebuttons:!1,prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttonup_class:null,buttondown_class:null,buttonup_txt:"+",buttondown_txt:"&minus;",callback_before_calculation:e=>e,callback_after_calculation:e=>e,renderer:null},b="_touchSpinCore",C=class T{constructor(t,i={}){if(this._teardownCallbacks=[],this._settingObservers=new Map,this._spinDelayTimeout=null,this._spinIntervalTimer=null,this._upButton=null,this._originalAttributes=null,this._downButton=null,this._mutationObserver=null,this._wrapper=null,!t||t.nodeName!=="INPUT")throw new Error("TouchSpinCore requires an <input> element");this.input=t;let s=this._parseDataAttributes(t),n=typeof globalThis<"u"&&globalThis.TouchSpinDefaultOptions?T.sanitizePartialSettings(globalThis.TouchSpinDefaultOptions,g):{};if(this.settings=Object.assign({},g,n,s,i),this._sanitizeSettings(),this._currentStepSize=this.settings.step||1,!this.settings.renderer){let r=globalThis;r?.TouchSpinDefaultRenderer?this.settings.renderer=r.TouchSpinDefaultRenderer:console.warn("TouchSpin: No renderer specified (renderer: null). Only keyboard/wheel events will work. Consider using Bootstrap3/4/5Renderer or TailwindRenderer for UI.")}if(this.spinning=!1,this.spincount=0,this.direction=!1,this._teardownCallbacks=[],this._settingObservers=new Map,this._spinDelayTimeout=null,this._spinIntervalTimer=null,this._upButton=null,this._downButton=null,this._wrapper=null,this._handleUpMouseDown=this._handleUpMouseDown.bind(this),this._handleDownMouseDown=this._handleDownMouseDown.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleUpKeyDown=this._handleUpKeyDown.bind(this),this._handleUpKeyUp=this._handleUpKeyUp.bind(this),this._handleDownKeyDown=this._handleDownKeyDown.bind(this),this._handleDownKeyUp=this._handleDownKeyUp.bind(this),this._handleWindowChangeCapture=this._handleWindowChangeCapture.bind(this),this._handleKeyDown=this._handleKeyDown.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleWheel=this._handleWheel.bind(this),this._initializeInput(),this.settings.renderer){let r=this.settings.renderer;this.renderer=new r(t,this.settings,this),this.renderer.init()}this._setupMutationObserver(),this.renderer&&this.renderer.finalizeWrapperAttributes(),this.input.setAttribute("data-touchspin-injected","input")}static sanitizePartialSettings(t,i){let s={...t};if(Object.hasOwn(t,"step")){let a=Number(t.step);s.step=Number.isFinite(a)&&a>0?a:1}if(Object.hasOwn(t,"decimals")){let a=Number(t.decimals);s.decimals=Number.isFinite(a)&&a>=0?Math.floor(a):0}let n=Object.hasOwn(t,"min"),r=Object.hasOwn(t,"max");if(n)if(t.min===null||t.min===void 0||typeof t.min=="string"&&t.min==="")s.min=null;else{let a=Number(t.min);s.min=Number.isFinite(a)?a:null}if(r)if(t.max===null||t.max===void 0||typeof t.max=="string"&&t.max==="")s.max=null;else{let a=Number(t.max);s.max=Number.isFinite(a)?a:null}if(n&&r&&s.min!=null&&s.max!=null&&typeof s.min=="number"&&typeof s.max=="number"&&s.min>s.max){let a=s.min;s.min=s.max,s.max=a}if(Object.hasOwn(t,"stepinterval")){let a=Number(t.stepinterval);s.stepinterval=Number.isFinite(a)&&a>=0?a:g.stepinterval}if(Object.hasOwn(t,"stepintervaldelay")){let a=Number(t.stepintervaldelay);s.stepintervaldelay=Number.isFinite(a)&&a>=0?a:g.stepintervaldelay}return s}_initializeInput(){this._captureOriginalAttributes();let t=this.settings.initval??"";t!==""&&this.input.value===""&&(this.input.value=String(t)),this._updateAriaAttributes(),this._syncNativeAttributes(),this._checkValue(!1)}_sanitizeSettings(){let t=Number(this.settings.step);!Number.isFinite(t)||t<=0?this.settings.step=1:this.settings.step=t;let i=Number(this.settings.decimals);if(!Number.isFinite(i)||i<0?this.settings.decimals=0:this.settings.decimals=Math.floor(i),this.settings.min===null||this.settings.min===void 0||typeof this.settings.min=="string"&&this.settings.min==="")this.settings.min=null;else{let r=Number(this.settings.min);this.settings.min=Number.isFinite(r)?r:null}if(this.settings.max===null||this.settings.max===void 0||typeof this.settings.max=="string"&&this.settings.max==="")this.settings.max=null;else{let r=Number(this.settings.max);this.settings.max=Number.isFinite(r)?r:null}if(this.settings.min!==null&&this.settings.max!==null&&this.settings.min>this.settings.max){let r=this.settings.min;this.settings.min=this.settings.max,this.settings.max=r}let s=Number(this.settings.stepinterval);(!Number.isFinite(s)||s<0)&&(this.settings.stepinterval=g.stepinterval);let n=Number(this.settings.stepintervaldelay);(!Number.isFinite(n)||n<0)&&(this.settings.stepintervaldelay=g.stepintervaldelay),this._validateCallbacks(),this._checkCallbackPairing()}_validateCallbacks(){if(this.input.getAttribute("type")!=="number")return;let i=r=>r;if(!this.settings.callback_after_calculation||this.settings.callback_after_calculation.toString()===i.toString())return;let n=this.settings.callback_after_calculation("123.45");/^-?\d*\.?\d*$/.test(n)||(console.warn('TouchSpin: Detected formatting callback that adds non-numeric characters. Converting input from type="number" to type="text" to support formatting like "'+n+'". This ensures compatibility with custom formatting while maintaining full TouchSpin functionality. The original type will be restored when TouchSpin is destroyed.'),this._captureOriginalAttributes(),this.input.setAttribute("type","text"),this.input.removeAttribute("min"),this.input.removeAttribute("max"),this.input.removeAttribute("step"))}_captureOriginalAttributes(){if(this._originalAttributes!==null)return;let t=["role","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","min","max","step"];this._originalAttributes={type:this.input.getAttribute("type"),attributes:new Map},t.forEach(i=>{this._originalAttributes?.attributes.set(i,this.input.getAttribute(i))})}_restoreOriginalAttributes(){if(this._originalAttributes===null)return;let t=this.input.value;if(t&&this.settings.callback_before_calculation){let i=this.settings.callback_before_calculation(t);this.input.value=i}this._originalAttributes.type&&this.input.setAttribute("type",this._originalAttributes.type),this._originalAttributes.attributes.forEach((i,s)=>{i===null?this.input.removeAttribute(s):this.input.setAttribute(s,i)}),this._originalAttributes=null}_parseDataAttributes(t){let i={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalup:"vertical-up",verticaldown:"vertical-down",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"},s={};for(let[n,r]of Object.entries(i)){let a=`data-bts-${r}`;if(t.hasAttribute(a)){let o=t.getAttribute(a);s[n]=this._coerceAttributeValue(n,o??"")}}for(let n of["min","max","step"])if(t.hasAttribute(n)){let r=t.getAttribute(n);s[n]!==void 0&&console.warn(`Both "data-bts-${n}" and "${n}" attributes specified. Native attribute takes precedence.`,t),s[n]=this._coerceAttributeValue(n,r??"")}return s}_coerceAttributeValue(t,i){if(i==null)return i;if(["booster","mousewheel","verticalbuttons","focusablebuttons"].includes(t))return i==="true"||i===""||i===t;if(["min","max","step","decimals","stepinterval","stepintervaldelay","boostat","maxboostedstep","firstclickvalueifempty"].includes(t)){let s=parseFloat(i);return Number.isNaN(s)?i:s}return i}upOnce(){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let t=this.getValue(),i=this._nextValue("up",t);if(this.settings.max!==null&&t===this.settings.max){this.emit("max"),this.spinning&&this.direction==="up"&&this.stopSpin();return}this.settings.max!==null&&i===this.settings.max&&(this.emit("max"),this.spinning&&this.direction==="up"&&this.stopSpin()),this._setDisplay(i,!0)}downOnce(){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let t=this.getValue(),i=this._nextValue("down",t);if(this.settings.min!==null&&t===this.settings.min){this.emit("min"),this.spinning&&this.direction==="down"&&this.stopSpin();return}this.settings.min!==null&&i===this.settings.min&&(this.emit("min"),this.spinning&&this.direction==="down"&&this.stopSpin()),this._setDisplay(i,!0)}startUpSpin(){let t=this.getValue();if(this.settings.max!==null&&t===this.settings.max){this.emit("max");return}this._startSpin("up")}startDownSpin(){let t=this.getValue();if(this.settings.min!==null&&t===this.settings.min){this.emit("min");return}this._startSpin("down")}stopSpin(){this._clearSpinTimers(),this.spinning&&(this.direction==="up"?(this.emit("stopupspin"),this.emit("stopspin")):this.direction==="down"&&(this.emit("stopdownspin"),this.emit("stopspin"))),this.spinning=!1,this.direction=!1,this.spincount=0,this._currentStepSize=this.settings.step||1}updateSettings(t){let i={...this.settings},s=t||{},n=T.sanitizePartialSettings(s,i);Object.assign(this.settings,n),this._sanitizeSettings();let r=Number(this.settings.step||1);(n.step!==void 0||n.min!==void 0||n.max!==void 0)&&r!==1&&(this.settings.max!==null&&(this.settings.max=this._alignToStep(Number(this.settings.max),r,"down")),this.settings.min!==null&&(this.settings.min=this._alignToStep(Number(this.settings.min),r,"up"))),Object.keys(this.settings).forEach(a=>{if(i[a]!==this.settings[a]){let o=this._settingObservers.get(String(a));o&&o.forEach(l=>{try{l(this.settings[a],i[a])}catch(p){console.error("TouchSpin: Error in setting observer callback:",p)}})}}),this._updateAriaAttributes(),this._syncNativeAttributes(),this._checkValue(!0),this._currentStepSize=this.settings.step||1,this._checkCallbackPairing()}getValue(){let t=this.input.value,i=this.settings.replacementval??"";if(t===""&&i!==""&&(t=String(i)),t==="")return NaN;let s=this.settings.callback_before_calculation||(r=>r),n=parseFloat(s(String(t)));return Number.isNaN(n)?NaN:n}setValue(t){if(this.input.disabled||this.input.hasAttribute("readonly"))return;let i=Number(t);if(!Number.isFinite(i))return;let s=this._applyConstraints(i),n=i!==s;this._setDisplay(s,!0,n,!1)}initDOMEventHandling(){this._findDOMElements(),this._attachDOMEventListeners()}registerTeardown(t){if(typeof t!="function")throw new Error("Teardown callback must be a function");return this._teardownCallbacks.push(t),()=>{let i=this._teardownCallbacks.indexOf(t);i>-1&&this._teardownCallbacks.splice(i,1)}}destroy(){this.input.removeAttribute("data-touchspin-injected"),this.stopSpin(),this.renderer?.teardown&&this.renderer.teardown(),this._detachDOMEventListeners(),this._teardownCallbacks.forEach(i=>{try{i()}catch(s){console.error("TouchSpin teardown callback error:",s)}}),this._teardownCallbacks.length=0,this._settingObservers.clear(),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),this._upButton=null,this._downButton=null,this._restoreOriginalAttributes();let t=this.input[b];t&&t===this&&delete this.input[b]}toPublicApi(){return{upOnce:this.upOnce.bind(this),downOnce:this.downOnce.bind(this),startUpSpin:this.startUpSpin.bind(this),startDownSpin:this.startDownSpin.bind(this),stopSpin:this.stopSpin.bind(this),updateSettings:this.updateSettings.bind(this),getValue:this.getValue.bind(this),setValue:this.setValue.bind(this),destroy:this.destroy.bind(this),initDOMEventHandling:this.initDOMEventHandling.bind(this),registerTeardown:this.registerTeardown.bind(this),attachUpEvents:this.attachUpEvents.bind(this),attachDownEvents:this.attachDownEvents.bind(this),observeSetting:this.observeSetting.bind(this)}}attachUpEvents(t){if(!t){console.warn("TouchSpin: attachUpEvents called with null element");return}this._upButton=t,t.addEventListener("mousedown",this._handleUpMouseDown),t.addEventListener("touchstart",this._handleUpMouseDown,{passive:!1}),this.settings.focusablebuttons&&(t.addEventListener("keydown",this._handleUpKeyDown),t.addEventListener("keyup",this._handleUpKeyUp)),this._updateButtonDisabledState()}attachDownEvents(t){if(!t){console.warn("TouchSpin: attachDownEvents called with null element");return}this._downButton=t,t.addEventListener("mousedown",this._handleDownMouseDown),t.addEventListener("touchstart",this._handleDownMouseDown,{passive:!1}),this.settings.focusablebuttons&&(t.addEventListener("keydown",this._handleDownKeyDown),t.addEventListener("keyup",this._handleDownKeyUp)),this._updateButtonDisabledState()}observeSetting(t,i){let s=String(t);this._settingObservers.has(s)||this._settingObservers.set(s,new Set);let n=this._settingObservers.get(s);return n.add(i),()=>n.delete(i)}emit(t,i,s=!1){let n=`touchspin.on.${t}`,r=new CustomEvent(n,{detail:i,bubbles:!0,cancelable:s});return!this.input.dispatchEvent(r)}_startSpin(t){if(this.input.disabled||this.input.hasAttribute("readonly")||this.spinning&&this.direction===t)return;if(this.spinning&&this.direction!==t&&this.stopSpin(),!this.spinning||this.direction!==t){if(this.spinning=!0,this.direction=t,this.spincount=0,this._currentStepSize=this.settings.step||1,this.emit("startspin"),t==="up"){if(this.emit("startupspin",void 0,!0)){this.spinning=!1,this.direction=!1;return}}else if(this.emit("startdownspin",void 0,!0)){this.spinning=!1,this.direction=!1;return}}t==="up"?this.upOnce():this.downOnce();let s=this.getValue();if(t==="up"&&this.settings.max!==null&&s===this.settings.max||t==="down"&&this.settings.min!==null&&s===this.settings.min)return;this._clearSpinTimers();let n=this.settings.stepintervaldelay||500,r=this.settings.stepinterval||100;this._spinDelayTimeout=setTimeout(()=>{this._spinDelayTimeout=null,this._spinIntervalTimer=setInterval(()=>{!this.spinning||this.direction!==t||this._spinStep(t)},r)},n)}_clearSpinTimers(){try{this._spinDelayTimeout&&clearTimeout(this._spinDelayTimeout)}catch{}try{this._spinIntervalTimer&&clearInterval(this._spinIntervalTimer)}catch{}this._spinDelayTimeout=null,this._spinIntervalTimer=null}_nextValue(t,i){let s=i;if(Number.isNaN(s))s=this._valueIfIsNaN();else{let n=this.settings.step||1,r=this.settings.maxboostedstep,a=n;if(this.settings.booster){let p=Math.max(1,parseInt(String(this.settings.boostat||10),10));a=2**Math.floor(this.spincount/p)*n}let o=a;r&&Number.isFinite(r)&&a>Number(r)&&(o=Number(r),s=Math.round(s/o)*o),o=Math.max(n,o);let l=this._currentStepSize??n;if(o<l&&(o=l),o>this._currentStepSize){let p=Math.floor(Math.log2(this._currentStepSize/n)),c=Math.floor(Math.log2(o/n)),m={currentLevel:p,newLevel:c,currentStep:this._currentStepSize,newStep:o,direction:t};if(this.emit("speedchange",m,!0))o=this._currentStepSize;else{let f=Number(m.newStep);Number.isFinite(f)&&f>=this.settings.step?o=Math.min(f,this.settings.maxboostedstep||Number.MAX_SAFE_INTEGER):o=this._currentStepSize}}this._currentStepSize=o,s=t==="up"?s+o:s-o}return this._applyConstraints(s)}_valueIfIsNaN(){if(typeof this.settings.firstclickvalueifempty=="number")return this.settings.firstclickvalueifempty;let t=typeof this.settings.min=="number"?this.settings.min:0,i=typeof this.settings.max=="number"?this.settings.max:t;return(t+i)/2}_applyConstraints(t){let i=this._forcestepdivisibility(t),s=this.settings.min??null,n=this.settings.max??null,r=i;return typeof s=="number"&&r<s&&(r=s),typeof n=="number"&&r>n&&(r=n),r}_getBoostedStep(){let t=this.settings.step||1;if(!this.settings.booster)return t;let i=Math.max(1,parseInt(String(this.settings.boostat||10),10)),s=2**Math.floor(this.spincount/i)*t,n=this.settings.maxboostedstep;if(n&&Number.isFinite(n)){let r=Number(n);s>r&&(s=r)}return Math.max(t,s)}_forcestepdivisibility(t){let i=this.settings.forcestepdivisibility||"round",s=this.settings.step||1,n=this.settings.decimals||0,r;switch(i){case"floor":r=Math.floor(t/s)*s;break;case"ceil":r=Math.ceil(t/s)*s;break;case"none":r=t;break;default:r=Math.round(t/s)*s;break}return Number(r.toFixed(n))}_alignToStep(t,i,s){if(i===0)return t;let n=1,r=i;for(;r*n%1!==0&&n<1e6;)n*=10;let a=Math.round(t*n),o=Math.round(i*n),l=a%o;return l===0?t:(s==="down"?a-l:a+(o-l))/n}_setDisplay(t,i,s=!1,n=!1){let r=String(this.input.value??""),a=this._formatDisplay(t);return this.input.value=a,this._updateAriaAttributes(),i&&(n?s:s||r!==a)&&this.input.dispatchEvent(new Event("change",{bubbles:!0})),a}_formatDisplay(t){let i=this.settings.decimals||0,s=this.settings.callback_after_calculation||(r=>r),n=Number(t).toFixed(i);return s(n)}_spinStep(t){this.spincount++,t==="up"?this.upOnce():this.downOnce()}_checkValue(t){let i=this.getValue();if(!Number.isFinite(i))return;let s=this._applyConstraints(i),n=i!==s;this._setDisplay(s,!!t,n)}_updateAriaAttributes(){let t=this.input;t.getAttribute("role")!=="spinbutton"&&t.setAttribute("role","spinbutton");let i=this.settings.min??null,s=this.settings.max??null;typeof i=="number"?t.setAttribute("aria-valuemin",String(i)):t.removeAttribute("aria-valuemin"),typeof s=="number"?t.setAttribute("aria-valuemax",String(s)):t.removeAttribute("aria-valuemax");let n=t.value,r=this.settings.callback_before_calculation||(o=>o),a=parseFloat(r(String(n)));Number.isFinite(a)?t.setAttribute("aria-valuenow",String(a)):t.removeAttribute("aria-valuenow"),t.setAttribute("aria-valuetext",String(n))}_syncNativeAttributes(){if(this.input.getAttribute("type")==="number"){let t=this.settings.min??null;typeof t=="number"&&Number.isFinite(t)?this.input.setAttribute("min",String(t)):this.input.removeAttribute("min");let i=this.settings.max??null;typeof i=="number"&&Number.isFinite(i)?this.input.setAttribute("max",String(i)):this.input.removeAttribute("max");let s=this.settings.step;typeof s=="number"&&Number.isFinite(s)&&s>0?this.input.setAttribute("step",String(s)):this.input.removeAttribute("step")}}_syncSettingsFromNativeAttributes(){let t=this.input.getAttribute("min"),i=this.input.getAttribute("max"),s=this.input.getAttribute("step"),n=!1,r={};if(t!==null){let a=t===""?null:parseFloat(t),o=a!==null&&Number.isFinite(a)?a:null;o!==this.settings.min&&(r.min=o,n=!0)}else this.settings.min!==null&&(r.min=null,n=!0);if(i!==null){let a=i===""?null:parseFloat(i),o=a!==null&&Number.isFinite(a)?a:null;o!==this.settings.max&&(r.max=o,n=!0)}else this.settings.max!==null&&(r.max=null,n=!0);if(s!==null){let a=s===""?void 0:parseFloat(s),o=a!==void 0&&Number.isFinite(a)&&a>0?a:void 0;o!==this.settings.step&&(r.step=o??1,n=!0)}else this.settings.step!==1&&(r.step=1,n=!0);n&&this.updateSettings(r)}_findDOMElements(){let t=this.input.parentElement;for(;t&&!t.hasAttribute("data-touchspin-injected");)t=t.parentElement;this._wrapper=t}_attachDOMEventListeners(){document.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("mouseleave",this._handleMouseUp),document.addEventListener("touchend",this._handleMouseUp),window.addEventListener("change",this._handleWindowChangeCapture,!0),this.input.addEventListener("keydown",this._handleKeyDown),this.input.addEventListener("keyup",this._handleKeyUp),this.input.addEventListener("wheel",this._handleWheel)}_detachDOMEventListeners(){document.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("mouseleave",this._handleMouseUp),document.removeEventListener("touchend",this._handleMouseUp),window.removeEventListener("change",this._handleWindowChangeCapture,!0),this.input.removeEventListener("keydown",this._handleKeyDown),this.input.removeEventListener("keyup",this._handleKeyUp),this.input.removeEventListener("wheel",this._handleWheel)}_handleUpMouseDown(t){t.preventDefault(),this.startUpSpin()}_handleDownMouseDown(t){t.preventDefault(),this.startDownSpin()}_handleMouseUp(t){this.stopSpin()}_handleUpKeyDown(t){if(t.keyCode===13||t.keyCode===32){if(t.preventDefault(),t.repeat)return;this.startUpSpin()}}_handleUpKeyUp(t){(t.keyCode===13||t.keyCode===32)&&this.stopSpin()}_handleDownKeyDown(t){if(t.keyCode===13||t.keyCode===32){if(t.preventDefault(),t.repeat)return;this.startDownSpin()}}_handleDownKeyUp(t){(t.keyCode===13||t.keyCode===32)&&this.stopSpin()}_handleWindowChangeCapture(t){let i=t.target;if(!i||i!==this.input)return;let s=this.getValue();if(!Number.isFinite(s))return;let n=this._applyConstraints(s);n!==s&&this._setDisplay(n,!1)}_handleKeyDown(t){switch(t.key){case"ArrowUp":if(t.preventDefault(),t.repeat)return;this.startUpSpin();break;case"ArrowDown":if(t.preventDefault(),t.repeat)return;this.startDownSpin();break;case"Enter":this._checkValue(!1);break}}_handleKeyUp(t){(t.key==="ArrowUp"||t.key==="ArrowDown")&&this.stopSpin()}_handleWheel(t){this.settings.mousewheel&&document.activeElement===this.input&&(t.preventDefault(),t.deltaY<0?this.upOnce():t.deltaY>0&&this.downOnce())}_setupMutationObserver(){typeof MutationObserver<"u"&&(this._mutationObserver=new MutationObserver(t=>{t.forEach(i=>{i.type==="attributes"&&(i.attributeName==="disabled"||i.attributeName==="readonly"?this._updateButtonDisabledState():(i.attributeName==="min"||i.attributeName==="max"||i.attributeName==="step")&&this._syncSettingsFromNativeAttributes())})}),this._mutationObserver.observe(this.input,{attributes:!0,attributeFilter:["disabled","readonly","min","max","step"]}))}_updateButtonDisabledState(){let t=this.input.disabled||this.input.hasAttribute("readonly");this._upButton&&(this._upButton.disabled=t),this._downButton&&(this._downButton.disabled=t),t&&this.stopSpin()}_checkCallbackPairing(){let t=n=>n,i=this.settings.callback_before_calculation&&this.settings.callback_before_calculation.toString()!==t.toString(),s=this.settings.callback_after_calculation&&this.settings.callback_after_calculation.toString()!==t.toString();if(i&&!s?console.warn("TouchSpin: callback_before_calculation is defined but callback_after_calculation is missing. These callbacks should be used together - one removes formatting, the other adds it back."):!i&&s&&console.warn("TouchSpin: callback_after_calculation is defined but callback_before_calculation is missing. These callbacks should be used together - one removes formatting, the other adds it back."),i&&s){let n=[],r=this.settings.decimals||0,a=c=>c.toFixed(r),o=this.settings.min!==null&&this.settings.min!==void 0,l=this.settings.max!==null&&this.settings.max!==void 0;o&&l?n.push(a(this.settings.min),a(this.settings.max)):o?n.push(a(this.settings.min)):l?n.push(a(this.settings.max)):n.push(r>0?"50.55":"50");let p=[];for(let c of n){let m=this.settings.callback_after_calculation?.(c);if(m===void 0)continue;let f=this.settings.callback_before_calculation?.(m);f!==void 0&&f!==c&&p.push(`"${c}" \u2192 after \u2192 "${m}" \u2192 before \u2192 "${f}" (expected "${c}")`)}p.length>0&&console.warn(`TouchSpin: Callbacks are not properly paired - round-trip test failed:
`+p.join(`
`)+`
callback_before_calculation must reverse what callback_after_calculation does. For example, if after adds " USD", before must strip " USD".`)}}};function k(e,t){if(!e||e.nodeName!=="INPUT")return console.warn("Must be an input."),null;if(t!==void 0){e[b]&&(console.warn("TouchSpin: Destroying existing instance and reinitializing. Consider using updateSettings() instead."),e[b]?.destroy());let i=new C(e,t);return e[b]=i,i.initDOMEventHandling(),i.toPublicApi()}if(!e[b]){let i=new C(e,{});return e[b]=i,i.initDOMEventHandling(),i.toPublicApi()}return e[b].toPublicApi()}var d=Object.freeze({MIN:"min",MAX:"max",START_SPIN:"startspin",START_UP:"startupspin",START_DOWN:"startdownspin",STOP_SPIN:"stopspin",STOP_UP:"stopupspin",STOP_DOWN:"stopdownspin"});function w(e){return{"vertical-buttons":"verticalbuttons","vertical-up":"verticalup","vertical-down":"verticaldown","vertical-up-class":"verticalupclass","vertical-down-class":"verticaldownclass","button-up-class":"buttonup_class","button-down-class":"buttondown_class","button-up-txt":"buttonup_txt","button-down-txt":"buttondown_txt","prefix-class":"prefix_extraclass","postfix-class":"postfix_extraclass","force-step-divisibility":"forcestepdivisibility","step-interval":"stepinterval","step-interval-delay":"stepintervaldelay","boost-at":"boostat","max-boosted-step":"maxboostedstep","mouse-wheel":"mousewheel","init-val":"initval","replacement-val":"replacementval","focusable-buttons":"focusablebuttons"}[e]||e}function E(e,t){if(e===null)return null;if(e==="")return!0;if(["verticalbuttons","mousewheel","booster","focusablebuttons"].includes(t))return e==="true"||e==="";if(["min","max","step","decimals","stepinterval","stepintervaldelay","boostat","maxboostedstep","firstclickvalueifempty"].includes(t)){let n=Number(e);return Number.isNaN(n)?null:n}return e}function D(e){let t={};for(let i of Array.from(e.attributes)){if(i.name==="is"||i.name.startsWith("data-testid"))continue;let s=w(i.name),n=E(i.value,s);n!==null&&(t[s]=n)}return t}var P=["min","max","step","value","decimals","prefix","postfix","vertical-buttons","vertical-up","vertical-down","button-up-txt","button-down-txt","mouse-wheel","disabled","readonly","renderer","force-step-divisibility","step-interval","step-interval-delay","booster","boost-at","max-boosted-step"];var nt={[d.MIN]:"touchspin-min",[d.MAX]:"touchspin-max",[d.START_SPIN]:"touchspin-start-spin",[d.START_UP]:"touchspin-start-up",[d.START_DOWN]:"touchspin-start-down",[d.STOP_SPIN]:"touchspin-stop-spin",[d.STOP_UP]:"touchspin-stop-up",[d.STOP_DOWN]:"touchspin-stop-down"};function I(e,t){let i=[];Object.entries({"touchspin.on.min":"touchspin-min","touchspin.on.max":"touchspin-max","touchspin.on.startspin":"touchspin-start-spin","touchspin.on.startupspin":"touchspin-start-up","touchspin.on.startdownspin":"touchspin-start-down","touchspin.on.stopspin":"touchspin-stop-spin","touchspin.on.stopupspin":"touchspin-stop-up","touchspin.on.stopdownspin":"touchspin-stop-down"}).forEach(([r,a])=>{let o=p=>{let c=new CustomEvent(a,{detail:{value:e.getValue(),instance:e,originalEvent:p},bubbles:!0,cancelable:!0});t.dispatchEvent(c)},l=t.querySelector("input");l&&(l.addEventListener(r,o),i.push(()=>l.removeEventListener(r,o)))});let n=t.querySelector("input");if(n){let r=a=>{let o=new CustomEvent("touchspin-change",{detail:{value:a.target.value,originalEvent:a,instance:e},bubbles:!0,cancelable:!0});t.dispatchEvent(o)};n.addEventListener("change",r),i.push(()=>n.removeEventListener("change",r))}return i}var _=class extends HTMLElement{static get observedAttributes(){return P.filter(t=>t!=="renderer")}constructor(t){super(),this._touchspin=null,this._input=null,this._eventUnsubscribers=[],this._isConnected=!1,this._renderer=t}setRenderer(t){this._renderer=t}connectedCallback(){this._isConnected=!0,this._initialize()}disconnectedCallback(){this._isConnected=!1,this._cleanup()}attributeChangedCallback(t,i,s){if(!this._isConnected||!this._touchspin)return;if(t==="value"){s!==i&&this._touchspin.setValue(s??"");return}if(t==="disabled"){this._input&&(this._input.disabled=s!==null);return}if(t==="readonly"){this._input&&(this._input.readOnly=s!==null);return}let n=w(t),r=E(s,n);this._touchspin?.updateSettings&&this._touchspin.updateSettings({[n]:r})}_initialize(){if(this._input=this.querySelector('input[type="number"]')||this.querySelector("input"),!this._input){this._input=document.createElement("input"),this._input.type="number";let i=this.getAttribute("name");i&&this._input.setAttribute("name",i),this.appendChild(this._input)}let t=D(this);this._renderer&&(t.renderer=this._renderer),this._applyInputAttributes(),this._touchspin=k(this._input,t),this._touchspin&&(this._eventUnsubscribers=I(this._touchspin,this))}_applyInputAttributes(){if(!this._input)return;let t=this.getAttribute("value");t!==null&&(this._input.value=t),this.hasAttribute("disabled")&&(this._input.disabled=!0),this.hasAttribute("readonly")&&(this._input.readOnly=!0);let i=this.getAttribute("name");i!==null&&this._input.setAttribute("name",i);let s=this.getAttribute("data-testid");s!==null&&this._input.setAttribute("data-testid",`${s}-input`);let n=["min","max","step","placeholder"];for(let r of n){let a=this.getAttribute(r);a!==null&&this._input.setAttribute(r,String(a))}}_cleanup(){this._eventUnsubscribers.forEach(t=>t()),this._eventUnsubscribers=[],this._touchspin?.destroy&&this._touchspin.destroy(),this._touchspin=null}get value(){return this._touchspin?this._touchspin.getValue():this._input?this._input.value:""}set value(t){this.setAttribute("value",String(t))}get min(){return this.getAttribute("min")}set min(t){t===null?this.removeAttribute("min"):this.setAttribute("min",String(t))}get max(){return this.getAttribute("max")}set max(t){t===null?this.removeAttribute("max"):this.setAttribute("max",String(t))}get step(){return this.getAttribute("step")}set step(t){t===null?this.removeAttribute("step"):this.setAttribute("step",String(t))}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get readonly(){return this.hasAttribute("readonly")}set readonly(t){t?this.setAttribute("readonly",""):this.removeAttribute("readonly")}upOnce(){this._touchspin?.upOnce&&this._touchspin.upOnce()}downOnce(){this._touchspin?.downOnce&&this._touchspin.downOnce()}startUpSpin(){this._touchspin?.startUpSpin&&this._touchspin.startUpSpin()}startDownSpin(){this._touchspin?.startDownSpin&&this._touchspin.startDownSpin()}stopSpin(){this._touchspin?.stopSpin&&this._touchspin.stopSpin()}updateSettings(t){this._touchspin?.updateSettings&&this._touchspin.updateSettings(t)}getTouchSpinInstance(){return this._touchspin}destroy(){this._cleanup()}};var x=null;function M(e,t){let i="touchspin-input";if(customElements.get(i)){x&&x!==t&&console.warn(`[TouchSpin] Custom element "${i}" is already defined with renderer "${x}". Skipping redefinition with "${t}". Only one renderer can be used per page.`);return}class n extends _{constructor(){super(e)}}customElements.define(i,n),x=t}M(O,"bootstrap5");return V(K);})();
